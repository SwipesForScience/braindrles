webpackJsonp([1],{"+Gxq":function(e,t,i){"use strict";var s=i("fnDg").a;var r=i("VU/8")(s,null,!1,function(e){i("/1Lr")},null,null);t.a=r.exports},"/1Lr":function(e,t){},0:function(e,t){},1:function(e,t){},"1zKb":function(e,t,i){e.exports=i.p+"static/img/braindrles.1059410.gif"},"4VBG":function(e,t){},"4ZIV":function(e,t){},"5pvD":function(e,t){},"6Swe":function(e,t){},"9M+g":function(e,t){},A0TE:function(e,t){},AhPL:function(e,t){},AtdB:function(e,t){},BQ6R:function(e,t){},BcDm:function(e,t){},BtPl:function(e,t){},DBwL:function(e,t){},EKwT:function(e,t){},EtLI:function(e,t){},F0zZ:function(e,t){},GHIx:function(e,t){},"HUt/":function(e,t,i){"use strict";var s=i("qRo1").a;var r=i("VU/8")(s,null,!1,function(e){i("PKAF")},null,null);t.a=r.exports},HbkR:function(e,t){},Hp3F:function(e,t){},HyhV:function(e,t){},JCpY:function(e,t,i){"use strict";var s=i("rKsW").a;var r=i("VU/8")(s,null,!1,function(e){i("rrPM")},null,null);t.a=r.exports},JDVb:function(e,t,i){"use strict";var s=i("9NuQ").a;var r=i("VU/8")(s,null,!1,function(e){i("nHb0")},null,null);t.a=r.exports},Jjjm:function(e,t){},Jmt5:function(e,t){},KZHh:function(e,t){},LOIk:function(e,t){},MEoe:function(e,t){},NGNY:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("7+uW"),r=i("Sazm"),n=i.n(r),a=i("fZjL"),o=i.n(a),u=i("e6fC"),l=(i("Jmt5"),i("9M+g"),i("mtWM")),c=i.n(l),d=i("M4fF"),p=i.n(d),h=i("RInU"),m=i.n(h),g=(i("AhPL"),i("1mcD")),f=i.n(g),v=(i("e0XP"),i("1zKb")),b={needsTutorial:!0,showConfigure:!1,needsConsent:!0,manifestS3:{bucketURL:"https://cors-anywhere.herokuapp.com/https://braindrlesgifs.s3-us-west-1.amazonaws.com/?list-type=2&prefix=gifbrles",bucket:"braindrlesgifs",prefix:"",delimiter:""},manifestType:"S3",widgetType:"ImageSwipe",widgetUsesSecret:!1,widgetProperties:{baseUrlTemplate:"https://s3-us-west-1.amazonaws.com/braindrlesgifs/{0}.gif",delimiter:"__",leftSwipeLabel:"Fail",rightSwipeLabel:"Pass"},iconAttribute:{name:"openmoji",url:"http://openmoji.org"},levels:{0:{level:0,min:0,max:10,character:null,img:null,img_grey:null,truth_prob:1},1:{level:1,min:11,max:25,character:"snail",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F40C.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F40C.svg?sanitize=true",truth_prob:.75},2:{level:2,min:26,max:50,character:"turtle",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F422.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F422.svg?sanitize=true",truth_prob:.5},3:{level:3,min:51,max:100,character:"panda",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F43C.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F43C.svg?sanitize=true",truth_prob:.4},4:{level:4,min:101,max:300,character:"koala",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F428.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F428.svg?sanitize=true",truth_prob:.2},5:{level:5,min:301,max:600,character:"tiger face",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F42F.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F42F.svg?sanitize=true",truth_prob:.15},6:{level:6,min:601,max:1e3,character:"two-hump camel",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F42B.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F42B.svg?sanitize=true",truth_prob:.1},7:{level:7,min:1001,max:2e3,character:"blowfish",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F421.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F421.svg?sanitize=true",truth_prob:.1},8:{level:8,min:2001,max:5e3,character:"spouting whale",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F433.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F433.svg?sanitize=true",truth_prob:.1},9:{level:9,min:5001,max:1e4,character:"octopus",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F419.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F419.svg?sanitize=true",truth_prob:.01},10:{level:10,min:10001,max:1e5,character:"unicorn face",img:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/1F984.svg?sanitize=true",img_grey:"https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/black/svg/1F984.svg?sanitize=true",truth_prob:1e-4}},betaMode:!1,firebaseKeys:{apiKey:"AIzaSyAYB2jWWdStY3yV8FjWo6pwIv6mLt2ezZw",authDomain:"braindrles.firebaseapp.com",databaseURL:"https://braindrles.firebaseio.com",projectId:"braindrles",storageBucket:"",messagingSenderId:"895217350482"},app:{navbarVariant:"danger"},home:{title:"braindrles",tagline:"Help us learn about stroke",backgroundUrl:i.n(v).a},play:{blankImage:"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_blank_canvas.svg?sanitize=true"},chats:{blankImage:"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_no_data.svg?sanitize=true"},profile:{blankImage:"https://raw.githubusercontent.com/SwipesForScience/testConfig/master/images/undraw_chatting.svg?sanitize=true"},tutorial:{customBackgroundAnimation:null,steps:{intro:[{},{text:"Stroke causes lesions, which appear as holes or darker colored regions in the brain:",image:"https://raw.githubusercontent.com/SwipesForScience/braindrles/master/src/assets/tutorialpics/gifbrles_031859_intro.gif"},{text:"Lesions can be anywhere in the brain and come in all shapes and sizes. \n\n          In a passing image, you can clearly see the lesion correctly labeled in red:",image:"https://raw.githubusercontent.com/SwipesForScience/braindrles/master/src/assets/tutorialpics/gifbrles_031910_large.gif"},{text:"In a failing image, the lesion mask (in red) is incorrectly labeled.\n          Sometimes the lesion mask covers healthy tissue:",image:"https://raw.githubusercontent.com/SwipesForScience/braindrles/master/src/assets/tutorialpics/fail_gifbrles_c0011s0006t01_no_lesion.gif"},{text:"Sometimes you won't see a lesion but there is a lesion mask anyway:",image:"https://raw.githubusercontent.com/SwipesForScience/braindrles/master/src/assets/tutorialpics/fail_gifbrles_c0007s0014t01_wrong.gif"}],examples:[{text:"Swipe right when the lesion is filled correctly",pointer:"gifbrles_031926",answer:1,tutorialStep:0},{text:"Swipe left when its bad",pointer:"gifbrles_c0005s0026t01",answer:0,tutorialStep:1},{text:"Sometimes the lesion is in a different part of the brain, but still correct, so you should swipe right",pointer:"gifbrles_031950",answer:1,tutorialStep:0},{text:"Other times, the lesion is more subtle, but still correct, so you should swipe right",pointer:"gifbrles_031946",answer:1,tutorialStep:0},{text:"Still other times, there may be more than one lesion - make sure the lesion mask covers all of the lesions before you swipe right",pointer:"gifbrles_031947",answer:1,tutorialStep:0},{text:"However, if the lesion mask is in the right place but too big (e.g. encompasses a lot of healthy tissue too), swipe left",pointer:"gifbrles_c0011s0009t01",answer:0,tutorialStep:1},{text:"And sometimes, the computer generates REALLY CRAZY lesion masks! Like this one. Definitely swipe left.",pointer:"gifbrles_c0007s0032t01",answer:0,tutorialStep:1},{text:"Finally, if you're not sure, click 'help' \n to discuss with scientists ",pointer:"gifbrles_031899",answer:0,tutorialStep:2},{text:"Are you ready to play? Don't worry about making mistakes - you'll get guidance on some brains as you go along, and you can always return to the tutorial or ask for help on a brain with the \"Help\" button if you're not sure",tutorialCompleted:!0}]}}},w=i("mvHQ"),y=i.n(w),_={data:function(){return{fkeys:null}},methods:{parseFirebaseKeys:function(){var e=this,t={};return p.a.map(["apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId"],function(i){t[i]=e.fkeys.split(i+': "')[1].split('"')[0]}),this.$emit("newFirebaseKeys",t),t}}},S={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",[e._v("Setting up your database")]),e._v(" "),e._m(0),e._v(" "),i("video",{staticClass:"video",attrs:{src:"https://s3.amazonaws.com/hotdognothotdog/createFirebaseProject.webm",controls:""}}),e._v(" "),i("label",{attrs:{for:"firebase"}},[e._v("Firebase Keys:")]),e._v(" "),i("b-textarea",{attrs:{placeholder:"Copy/paste your firebase API keys from the firebase console in here",rows:5},model:{value:e.fkeys,callback:function(t){e.fkeys=t},expression:"fkeys"}}),e._v(" "),i("b-button",{staticClass:"mt-2 mb-2",attrs:{variant:"secondary",disabled:!e.fkeys},on:{click:e.parseFirebaseKeys}},[e._v("Apply")])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("ol",{staticClass:"text-left ml-3 pl-3"},[t("li",[this._v("\n      Create a new Firebase project\n      at "),t("a",{attrs:{href:"https://console.firebase.google.com"}},[this._v("console.firebase.google.com")])]),this._v(" "),t("li",[this._v('\n      Copy the API keys to the text box below and hit "Apply"\n    ')])])}]};var k=i("VU/8")(_,S,!1,function(e){i("EtLI")},"data-v-5b15f801",null).exports,C={props:{config:{type:Object,required:!0}},data:function(){return{}},methods:{},mounted:function(){this.$router&&this.$router.replace("/admin")}},P={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",[e._v("App")]),e._v(" "),i("label",{attrs:{for:"manifestUrl"}},[e._v("manifestUrl")]),e._v(" "),i("b-form-input",{attrs:{type:"text",id:"manifestUrl"},model:{value:e.config.manifestUrl,callback:function(t){e.$set(e.config,"manifestUrl",t)},expression:"config.manifestUrl"}})],1)},staticRenderFns:[]};var x=i("VU/8")(C,P,!1,function(e){i("nLSV")},null,null).exports,T={props:{config:{type:Object,required:!0}},data:function(){return{navbarOptions:["primary","secondary","info","warning","danger"]}},mounted:function(){this.$router&&this.$router.replace("/")}},I={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",{staticClass:"mt3 pt-3"},[e._v("Home")]),e._v(" "),i("label",{attrs:{for:"navbarVariant"}},[e._v("Navbar variant:")]),e._v(" "),i("b-form-select",{staticClass:"mb-3",attrs:{id:"navbarVariant",options:e.navbarOptions},model:{value:e.config.app.navbarVariant,callback:function(t){e.$set(e.config.app,"navbarVariant",t)},expression:"config.app.navbarVariant"}}),e._v(" "),i("label",{attrs:{for:"title"}},[e._v("Title")]),e._v(" "),i("b-form-input",{attrs:{type:"text",id:"title",placeholder:"your title here"},model:{value:e.config.home.title,callback:function(t){e.$set(e.config.home,"title",t)},expression:"config.home.title"}}),e._v(" "),i("label",{staticClass:"mt-2",attrs:{for:"tagline"}},[e._v("Tagline")]),e._v(" "),i("b-form-input",{attrs:{type:"text",id:"tagline",placeholder:"your tagline here"},model:{value:e.config.home.tagline,callback:function(t){e.$set(e.config.home,"tagline",t)},expression:"config.home.tagline"}}),e._v(" "),i("label",{staticClass:"mt-2",attrs:{for:"backgroundUrl"}},[e._v("Background URL")]),e._v(" "),i("b-form-input",{attrs:{type:"text",id:"backgroundUrl",placeholder:"url to a picture"},model:{value:e.config.home.backgroundUrl,callback:function(t){e.$set(e.config.home,"backgroundUrl",t)},expression:"config.home.backgroundUrl"}})],1)},staticRenderFns:[]},U=i("VU/8")(T,I,!1,null,null,null).exports,F={props:{config:{type:Object,required:!0}}},q={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",{staticClass:"mt3 pt-3"},[e._v("Tutorial")]),e._v(" "),i("div",{staticClass:"form-check"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.config.needsTutorial,expression:"config.needsTutorial"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"defaultCheck1"},domProps:{checked:Array.isArray(e.config.needsTutorial)?e._i(e.config.needsTutorial,null)>-1:e.config.needsTutorial},on:{change:function(t){var i=e.config.needsTutorial,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n=e._i(i,null);s.checked?n<0&&e.$set(e.config,"needsTutorial",i.concat([null])):n>-1&&e.$set(e.config,"needsTutorial",i.slice(0,n).concat(i.slice(n+1)))}else e.$set(e.config,"needsTutorial",r)}}}),e._v(" "),i("label",{staticClass:"form-check-label",attrs:{for:"defaultCheck1"}},[e._v("\n      Needs a tutorial?\n    ")])])])},staticRenderFns:[]};var L=i("VU/8")(F,q,!1,function(e){i("xfUb")},null,null).exports,R=i("GDE4"),E=i.n(R),M=i("rxKx"),j=i.n(M),D=i("A4r5"),O=(i("Hp3F"),i("Or8B")),$=i.n(O);function V(e,t){var i=e.createImageData(t.width,t.height);return i.data.set(t.data),i}s.default.component("resize-observer",D.a),$.a.Raster.prototype.process=function(e){for(var t=V(this.getContext("2d"),this.origImg),i=0;i<this.width;i+=1)for(var s=0;s<this.height;s+=1){var r=4*(s*this.width+i),n=e(t.data[r],t.data[r+1],t.data[r+2],t.data[r+3],i,s);t.data[r]=n[0],t.data[r+1]=n[1],t.data[r+2]=n[2],t.data[r+3]=n[3]}this.setImageData(t)},$.a.Raster.prototype.brightness_contrast=function(e,t){var i=t;return i=Math.pow((i+100)/100,2),this.process(function(t,s,r,n){return[255*((t/255-.5)*i+.5)*e,255*((s/255-.5)*i+.5)*e,255*((r/255-.5)*i+.5)*e,n]})};var N={clamp:function(e,t,i){var s=i||0,r=t||0;return Math.max(r,Math.min(e,s))},clampPoint:function(e,t,i,s,r){var n=t||0,a=i||0;return new $.a.Point({x:N.clamp(e.x,n,a),y:N.clamp(e.y,s,r)})},get_local:function(e,t){var i=t.size.width/2,s=t.size.height/2,r=t.globalToLocal(e.point);return(r=N.clampPoint(r,0-i,i,0-s,s)).x=Math.floor(r.x+i),r.y=Math.floor(r.y+s),r},get_global:function(e,t){var i=t.size.width/2,s=t.size.height/2,r={};return r.x=e.x-i,r.y=e.y-s,r=t.localToGlobal(r)}},A={name:"Paper",data:function(){return{base:null,mask:null,contour:null,view:null,viewHeight:null,zoomFactor:1,touch:{startScale:null,mode:null},scope:null,panFactor:{x:0,y:0},panMouseDown:null,drawOrPan:"draw",draw:{points:[],shapes:[]},deleteRadius:6}},methods:{activate:function(){this.scope.activate()},undo:function(){this.draw.points.pop();var e=this.draw.shapes.pop();e&&e.remove()},doZoom:function(e){e.preventDefault();var t=this.zoomFactor+e.deltaY/200;this.zoomFactor=N.clamp(t,.3,3),this.view.setZoom(this.zoomFactor)},doPan:function(e){null==this.panMouseDown&&(this.panMouseDown=e,this.drawOrPan="pan"),this.panFactor.x=e.point.x-this.panMouseDown.point.x,this.panFactor.y=e.point.y-this.panMouseDown.point.y,this.view.translate(this.panFactor.x,this.panFactor.y)},resetPan:function(){this.panFactor.x=0,this.panFactor.y=0,this.panMouseDown=null},onresize:function(){var e=this;document.body.scrollHeight!==this.viewHeight&&this.base&&this.mask&&this.contour&&(this.view.setZoom(1),this.base.fitBounds(this.view.bounds),this.mask.fitBounds(this.view.bounds),this.contour.fitBounds(this.view.bounds),this.draw.shapes.forEach(function(t,i){t.position=N.get_global(e.draw.points[i],e.base)}),this.zoomFactor=1)},takeScreenshot:function(){var e="<iframe width='100%' height='100%' src=\""+this.view._context.canvas.toDataURL()+'" style="border: none;"></iframe>',t=window.open();t.document.open(),t.document.write(e),t.document.close()},drawSplat:function(e,t){var i=new $.a.Shape.Circle(e.point,this.splatRadius);i.strokeColor=this.splatColor,i.strokeWidth=2,i.onClick=this.clickHandler,this.draw.shapes.push(i);var s=N.get_local(e,t);this.draw.points.push(s),this.base.addChild(i)},checkToRemove:function(e,t){var i=this,s=N.get_local(e,t),r=[],n=p.a.filter(this.draw.points,function(e,t){var n=Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2));return n<i.deleteRadius&&r.push(t),n<i.deleteRadius});return{shapeIdxToRemove:r,pointsToRemove:n}},removeSplat:function(e){var t=this;p.a.map(e.shapeIdxToRemove,function(e){t.draw.shapes[e].remove()}),p.a.remove(this.draw.shapes,function(t,i){return e.shapeIdxToRemove.indexOf(i)>-1}),p.a.remove(this.draw.points,function(t,i){return e.shapeIdxToRemove.indexOf(i)>-1})},dragHandler:function(e){(2===e.event.buttons||this.touch.mode)&&this.doPan(e)},clickHandler:function(e){if(2!==e.event.button&&"draw"===this.drawOrPan){var t=this.checkToRemove(e,this.base);t.pointsToRemove.length?this.removeSplat(t):this.drawSplat(e,this.base)}else this.drawOrPan="draw"},brightcont:function(){var e=(parseInt(this.brightness,10)-50)/50+1,t=2*parseInt(this.contrast,10)-100;this.base.brightness_contrast(e,t)},removeEvents:function(){var e=this.$refs.canvas;e&&(e.removeEventListener("resize",this.onresize),e.removeEventListener("mousewheel",this.doZoom))},clearImg:function(){this.scope.paper.project.clear(),this.draw.history=[[]],this.zoomFactor=1,this.view.setZoom(1),this.panFactor={x:0,y:0}},initImg:function(){this.scope.activate(),this.base=new this.scope.paper.Raster({source:this.paperSrc,crossOrigin:"anonymous"}),this.base.visible=!0,this.view=this.scope.view;var e=this;this.base.onLoad=function(){this.visible=!0;var t=e.view._context;t.mozImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.msImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1,function(e,t){e.visible=!0,e.position=t.view.center,e.fitBounds(t.view.bounds);var i=document.createElement("canvas");i.width=e.width,i.height=e.height;var s=i.getContext("2d");e.origImg=V(s,e.canvas.getContext("2d").getImageData(0,0,e.width,e.height))}(this,e.scope),e.base.onMouseDrag=e.dragHandler,e.base.onClick=e.clickHandler,e.base.onMouseUp=e.resetPan,e.mask=new e.scope.paper.Raster({source:e.maskSrc,crossOrigin:"anonymous"}),e.mask.onLoad=function(){e.mask.visible=e.visibility.mask,e.mask.setSize(e.base.size),e.mask.position=e.scope.view.center,e.mask.fitBounds(e.scope.view.bounds),e.mask.onMouseDrag=e.dragHandler,e.mask.onClick=e.clickHandler,e.mask.onMouseUp=e.resetPan,e.mask.opacity=.5},e.contour=new e.scope.paper.Raster({source:e.contourSrc,crossOrigin:"anonymous"}),e.contour.onLoad=function(){e.contour.visible=e.visibility.contour,e.contour.setSize(e.base.size),e.contour.position=e.scope.view.center,e.contour.fitBounds(e.scope.view.bounds),e.contour.onMouseDrag=e.dragHandler,e.contour.onClick=e.clickHandler,e.contour.onMouseUp=e.resetPan,e.contour.opacity=.5},e.brightcont(),e.$emit("loaded_image",e.id)}}},watch:{paperSrc:function(){this.clearImg(),this.initImg()},brightness:function(){this.brightcont()},contrast:function(){this.brightcont()},visibility:{handler:function(){this.contour.visible=this.visibility.contour,this.mask.visible=this.visibility.mask},deep:!0}},props:{paperSrc:{type:String,default:null},maskSrc:{type:String,default:null},contourSrc:{type:String,default:null},visibility:{type:Object,default:{contour:!0,mask:!0}},brightness:{type:Number,default:50},contrast:{type:Number,default:50},id:{type:String,default:"canvas-id"},splatRadius:{type:Number,default:10},splatColor:{type:String,default:"#ffc107"}},beforeDestroy:function(e,t,i){this.removeEvents(),i&&i()},mounted:function(){var e=this;this.$nextTick(function(){var t=new $.a.PaperScope;t.setup(e.$refs.canvas),e.scope=t,e.initImg();var i=e.$refs.canvas;i.addEventListener("resize",e.onresize),i.addEventListener("mousewheel",e.doZoom);var s=e,r=new j.a.Manager(i,{stopPropagation:!0,preventDefault:!0}),n=new j.a.Pinch;r.add(n);var a=1;r.on("pinch",function(e){e&&(e.preventDefault(),a=N.clamp(e.scale/s.touch.startScale*s.zoomFactor,1,5),s.view.setZoom(a))}),r.on("pinchend",function(e){s.touch.mode=!1,e&&(e.preventDefault(),s.zoomFactor=a,s.panMouseDown=null,s.drawOrPan="pan")}),r.on("pinchstart",function(e){e&&(s.touch.mode=!0,e.preventDefault(),s.touch.startScale=e.scale,s.drawOrPan="pan")})})}},z={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"paper",attrs:{oncontextmenu:"return false;"}},[t("resize-observer",{on:{notify:this.onresize}}),this._v(" "),t("canvas",{ref:"canvas",staticStyle:{width:"100%",height:"100%"},attrs:{id:this.id,resize:""},on:{click:this.activate}})],1)},staticRenderFns:[]};var H=i("VU/8")(A,z,!1,function(e){i("BtPl")},null,null).exports,B={name:"ImageSplat",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{overlayStyle:{opacity:.5},visible:{mask:!0,contour:!0},brightness:50,contrast:50,brightnessOptions:{eventType:"auto",width:"auto",height:6,dotSize:16,dotHeight:null,dotWidth:null,min:0,max:100,interval:1,show:!0,speed:.5,disabled:!1,piecewise:!1,piecewiseStyle:{},piecewiseLabel:!1,tooltip:!1,tooltipDir:"top",reverse:!1,data:null,clickable:!0,realTime:!0,lazy:!0,formatter:null,bgStyle:null,sliderStyle:null,processStyle:{"background-color":"#17a2b8"},piecewiseActiveStyle:null,tooltipStyle:null,labelStyle:null,labelActiveStyle:null}}},mounted:function(){},components:{Paper:H,vueSlider:E.a},computed:{maskUrl:function(){return this.widgetProperties.maskUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.maskUrlTemplate,this.widgetProperties.delimiter):null},baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null},contourUrl:function(){return this.widgetProperties.contourUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.contourUrlTemplate,this.widgetProperties.delimiter):null}},watch:{},methods:{setUserSettings:function(){this.contrast=this.userSettings.contrast||50,this.brightness=this.userSettings.brightness||50},undo:function(){this.$refs.paper.undo()},fillPropertyPattern:function(e,t){var i=e,s=String(this.widgetPointer).split(t);return p.a.map(s,function(e,t){i=i.replace("{"+t+"}",e)}),i},getScore:function(e){return"danger"===this.getFeedback(e).variant?0:1},getFeedback:function(e){var t=void 0;if((t=this.widgetSummary?this.widgetSummary:{count:0}).count>4){var i=t.points.length/t.count;return i>=.7&&!e.length?{show:!1,variant:"danger",message:"+0 you missed some points"}:i<=.3&&e.length?{show:!1,variant:"danger",message:"+0 you did not need to mark points"}:{show:!0,variant:"success",message:"+1 good job"}}return{show:!0,variant:"success",message:"+1 thanks"}},getSummary:function(e){if(!this.widgetSummary)return{points:[e],count:1};var t=this.widgetSummary.points;return t.push([e]),{points:t,count:this.widgetSummary.count+1}},getSplatPoints:function(){return p.a.map(this.$refs.paper.draw.points,function(e){return{x:e.x,y:e.y}})},vote:function(){this.$emit("updateUserSettings",{brightness:this.brightness,contrast:this.contrast}),this.$emit("widgetRating",this.getSplatPoints())},getPropertiesSchema:function(){return{baseUrlTemplate:{type:String,required:!0,description:"base url to the image file"},maskUrlTemplate:{type:String,required:!0,description:"base url to the mask file"},contourUrlTemplate:{type:String,required:!0,description:"base url to the contour file"},delimiter:{type:String,required:!1,default:"__",description:"how to split the sample ID to fill in the template"}}},test:function(){var e=[],t=[{x:0,y:0}];return this.getScore(e),this.getScore(t),this.getFeedback(t),this.getFeedback(e),this.getSummary(t),this.getSummary(e),this.vote(t),this.vote(e),this.getPropertiesSchema(),1}}},W={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"imageSplat"},[i("div",{staticClass:"parent user-card"},[i("Paper",{ref:"paper",attrs:{paperSrc:e.baseUrl,maskSrc:e.maskUrl,contourSrc:e.contourUrl,visibility:e.visible,brightness:e.brightness,contrast:e.contrast,id:"baseImage"},on:{loaded_image:e.setUserSettings}}),e._v(" "),e.playMode?i("div",{staticClass:"user-card__name mb-3 pb-3 mt-2 pt-3"},[i("div",{staticClass:"row"},[e._m(0),e._v(" "),i("div",{staticClass:"col-10"},[i("vue-slider",e._b({ref:"slider1",model:{value:e.brightness,callback:function(t){e.brightness=t},expression:"brightness"}},"vue-slider",e.brightnessOptions,!1))],1)]),e._v(" "),i("div",{staticClass:"row mb-2"},[e._m(1),e._v(" "),i("div",{staticClass:"col-10"},[i("vue-slider",e._b({ref:"slider1",model:{value:e.contrast,callback:function(t){e.contrast=t},expression:"contrast"}},"vue-slider",e.brightnessOptions,!1))],1)]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"danger"},on:{click:e.undo}},[i("i",{staticClass:"fa fa-undo"})]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3 pl-3 pr-3",attrs:{variant:"info",to:"/review/"+e.widgetPointer}},[i("i",{staticClass:"fa fa-question"})]),e._v(" "),i("b-dropdown",{staticClass:" mx-auto ml-2 mr-2",attrs:{id:"ddown-dropup",dropup:"",variant:"secondary"}},[i("template",{slot:"button-content"},[i("i",{staticClass:"fa fa-eye"})]),e._v(" "),i("b-dropdown-item",{on:{click:function(t){e.visible.mask=!e.visible.mask}}},[e.visible.mask?i("i",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}}):e._e(),e._v("\n          Mask\n        ")]),e._v(" "),i("b-dropdown-item",{on:{click:function(t){e.visible.contour=!e.visible.contour}}},[e.visible.contour?i("i",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}}):e._e(),e._v("\n          Contour\n        ")])],2),e._v(" "),i("b-btn",{staticClass:" mx-auto ml-3 mr-3",attrs:{variant:"success"},on:{click:function(t){return e.vote(1)}}},[e._v("\n        Submit "),i("i",{staticClass:"fa fa-arrow-right"})])],1):e._e()],1),e._v(" "),e.playMode?e._e():i("p",{staticClass:"mt-3 pt-3 mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetSummary))])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"col-1"},[t("i",{staticClass:"fa fa-sun-o"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"col-1"},[t("i",{staticClass:"fa fa-adjust"})])}]};var G=i("VU/8")(B,W,!1,function(e){i("UFIT")},"data-v-01e20630",null).exports,Q=i("MUua"),Y=i("iPd/"),K=i.n(Y),Z={name:"PulseLoader",props:{loading:{type:Boolean,default:!0},color:{type:String,default:"#5dc596"},size:{type:String,default:"15px"},margin:{type:String,default:"2px"},radius:{type:String,default:"100%"}},data:function(){return{spinnerStyle:{backgroundColor:this.color,width:this.size,height:this.size,margin:this.margin,borderRadius:this.radius,display:"inline-block",animationName:"v-pulseStretchDelay",animationDuration:"0.75s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.2,.68,.18,1.08)",animationFillMode:"both"},spinnerDelay1:{animationDelay:"0.12s"},spinnerDelay2:{animationDelay:"0.24s"},spinnerDelay3:{animationDelay:"0.36s"}}}},J={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{directives:[{name:"show",rawName:"v-show",value:this.loading,expression:"loading"}],staticClass:"v-spinner"},[t("div",{staticClass:"v-pulse v-pulse1",style:[this.spinnerStyle,this.spinnerDelay1]}),t("div",{staticClass:"v-pulse v-pulse2",style:[this.spinnerStyle,this.spinnerDelay2]}),t("div",{staticClass:"v-pulse v-pulse3",style:[this.spinnerStyle,this.spinnerDelay3]})])},staticRenderFns:[]};var X=i("VU/8")(Z,J,!1,function(e){i("KZHh")},null,null).exports,ee=i("vlaz"),te=i.n(ee);s.default.use(te.a),s.default.use(Q.VueHammer),s.default.use(i("m0IH"));var ie={name:"ImageSwipe",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},components:{VueHammer:Q.VueHammer,GridLoader:X},directives:{imagesLoaded:K.a},data:function(){return{status:"loading",swipe:null,groundTruthUrl:"",groundTruthFeedback:"",groundTruthValue:null,groundTruthPointer:null}},computed:{baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null}},mounted:function(){var e=this;this.$nextTick(function(){"tutorial"===e.playMode&&e.showTutorialStep(e.tutorialStep)})},methods:{showTutorialStep:function(e){switch(e){case 0:this.$refs.rightSwipe.classList.add("focus");break;case 1:this.$refs.leftSwipe.classList.add("focus");break;case 2:this.$refs.helpButton.classList.add("focus")}},fillPropertyPattern:function(e,t){var i=e,s=String(this.widgetPointer).split(t);return p.a.map(s,function(e,t){i=i.replace("{"+t+"}",e)}),i},getScore:function(e,t){var i=this.getFeedback(e,t);return"danger"!==i.variant||p.a.isEmpty(t)?"danger"===i.variant?0:1:-1},showFeedbackModal:function(e){this.groundTruthUrl=this.widgetProperties.baseUrlTemplate&&e[".key"]?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null,this.groundTruthFeedback=e.feedback,this.groundTruthValue=e.truth,this.groundTruthPointer=e[".key"],this.$refs.groundTruthFeedbackModal.show()},getFeedback:function(e,t){if(!p.a.isEmpty(t))return e!==t.truth?{show:!0,variant:"danger",message:t.feedback||"That's not right! Take another look.",needsModal:!0}:{show:!0,variant:"success",message:"You're correct!"};var i=void 0;if((i=this.widgetSummary?this.widgetSummary:{count:0}).count>4){var s=i.aveVote;return s>=.7&&!e?{show:!0,variant:"danger",message:"+0 most people swiped right"}:s<=.3&&e?{show:!0,variant:"danger",message:"+0 most people swiped left"}:{show:!0,variant:"success",message:"+1 good job"}}return{show:!0,variant:"success",message:"+1 thanks"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{baseUrlTemplate:{type:String,required:!0,description:"base url to the image file"},delimiter:{type:String,required:!1,default:"__",description:"how to split the sample ID to fill in the template"},leftSwipeLabel:{type:String,required:!1,default:"Fail",description:"label for the left swipe button"},rightSwipeLabel:{type:String,required:!1,default:"True",description:"label for the right swipe button"}}},swipeLeft:function(){this.setSwipe("swipe-left"),this.vote(0)},swipeRight:function(){this.setSwipe("swipe-right"),this.vote(1)},onSwipe:function(e){2===e.direction?this.swipeLeft():this.swipeRight()},setSwipe:function(e){this.swipe=e},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),"play"===this.playMode&&(this.showTutorialStep(0),this.showTutorialStep(1),this.showTutorialStep(2)),this.swipeLeft(),this.swipeRight(),this.onSwipe({direction:1}),this.onSwipe({direction:2}),this.setSwipe("swipe-left"),this.getPropertiesSchema(),1}}},se={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"imageSwipe"},[i("b-modal",{ref:"groundTruthFeedbackModal",attrs:{title:"Take another look","ok-only":!0}},[i("p",{staticClass:"lead"},[e.groundTruthValue?i("span",{staticClass:"text-success"},[i("b",[e._v(e._s(e.groundTruthFeedback))])]):i("span",{staticClass:"text-danger"},[i("b",[e._v(e._s(e.groundTruthFeedback))])])]),e._v(" "),i("progressive-img",{staticClass:"user-card__picture mx-auto",attrs:{src:e.groundTruthUrl,placeholder:"https://unsplash.it/500","aspect-ratio":1}}),e._v(" "),i("p",{staticClass:"mt-3 pt-3"},[e._v("\n        Still have questions?\n        "),i("br"),e._v(" "),e.playMode?i("b-button",{ref:"helpButton",staticClass:"helpbtn",attrs:{to:"/review/"+e.groundTruthPointer,variant:"info"}},[e._v("\n       Discuss with scientists\n       ")]):e._e()],1)],1),e._v(" "),i("transition",{key:e.swipe,attrs:{name:e.swipe}},[i("div",{key:e.baseUrl,staticClass:"user-card"},[i("div",{staticClass:"image_area"},[i("progressive-img",{directives:[{name:"hammer",rawName:"v-hammer:swipe.horizontal",value:e.onSwipe,expression:"onSwipe",arg:"swipe",modifiers:{horizontal:!0}}],staticClass:"user-card__picture mx-auto",attrs:{src:e.baseUrl,placeholder:"https://unsplash.it/500","aspect-ratio":1}})],1),e._v(" "),i("div",{staticClass:"user-card__name"},[e.playMode?i("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowleft"],expression:"['arrowleft']"},{name:"hammer",rawName:"v-hammer:swipe.left",value:e.swipeLeft,expression:"swipeLeft",arg:"swipe",modifiers:{left:!0}}],ref:"leftSwipe",staticStyle:{float:"left"},attrs:{variant:"danger"},on:{click:e.swipeLeft,shortkey:e.swipeLeft}},[i("i",{staticClass:"fa fa-long-arrow-left",attrs:{"aria-hidden":"true"}}),e._v("\n            "+e._s(e.widgetProperties.leftSwipeLabel)+"\n           ")]):i("span",{staticStyle:{float:"left"}},[e.widgetSummary?i("span",[e._v(" ave vote: "+e._s(e.widgetSummary.aveVote||0)+" ")]):i("span",[e._v("ave vote: N/A")])]),e._v(" "),e.playMode?i("b-button",{ref:"helpButton",staticClass:"helpbtn",attrs:{to:"/review/"+e.widgetPointer}},[e._v("Help")]):e._e(),e._v(" "),e.playMode?i("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowright"],expression:"['arrowright']"}],ref:"rightSwipe",staticStyle:{float:"right"},attrs:{variant:"success"},on:{click:e.swipeRight,shortkey:e.swipeRight}},[e._v(" "+e._s(e.widgetProperties.rightSwipeLabel)+"\n            "),i("i",{staticClass:"fa fa-long-arrow-right",attrs:{"aria-hidden":"true"}})]):i("span",{staticStyle:{float:"right"}},[e.widgetSummary?i("span",[e._v(" num votes: "+e._s(e.widgetSummary.count||0)+" ")]):i("span",[e._v("num votes: 0")])])],1)])])],1)},staticRenderFns:[]};var re=i("VU/8")(ie,se,!1,function(e){i("xBZt")},"data-v-54d7279d",null).exports;s.default.use(te.a),s.default.use(Q.VueHammer),s.default.use(i("m0IH"));var ne={name:"ImageSoundSwipe",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},playMode:{type:String,required:!1},userSettings:{type:Object,required:!0},tutorialStep:{type:Number,required:!1}},components:{VueHammer:Q.VueHammer,GridLoader:X},directives:{imagesLoaded:K.a},data:function(){return{status:"loading",swipe:null,currentAudio:null}},watch:{widgetPointer:function(){"tutorial"!==this.playMode&&this.playSound()}},mounted:function(){var e=this;this.$nextTick(function(){"tutorial"!==e.playMode?e.playSound():e.showTutorialStep(e.tutorialStep)})},computed:{baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null},soundUrl:function(){return this.widgetProperties.soundUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.soundUrlTemplate,this.widgetProperties.delimiter):null}},methods:{showTutorialStep:function(e){switch(e){case 0:this.$refs.rightSwipe.classList.add("focus");break;case 1:this.$refs.leftSwipe.classList.add("focus");break;case 2:this.$refs.helpButton.classList.add("focus")}},fillPropertyPattern:function(e,t){var i=e,s=String(this.widgetPointer).split(t);return p.a.map(s,function(e,t){i=i.replace("{"+t+"}",e)}),i},playSound:function(){this.currentAudio&&(this.currentAudio.pause(),this.currentAudio=null);var e=new Audio(this.soundUrl);this.currentAudio=e,e.play();var t=this;e.onended=function(){t.currentAudio=null}},getScore:function(e){return"danger"===this.getFeedback(e).variant?0:1},getFeedback:function(e){var t=void 0;if((t=this.widgetSummary?this.widgetSummary:{count:0}).count>4){var i=t.aveVote;return i>=.7&&!e?{show:!1,variant:"danger",message:"+0 most people swiped right"}:i<=.3&&e?{show:!1,variant:"danger",message:"+0 most people swiped left"}:{show:!0,variant:"success",message:"+1 good job"}}return{show:!0,variant:"success",message:"+1 thanks"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{baseUrlTemplate:{type:String,required:!0,description:"base url to image file"},soundUrlTemplate:{type:String,required:!0,description:"url to sound file"},delimiter:{type:String,required:!1,default:"__",description:"how to split the sample ID to fill the template"},leftSwipeLabel:{type:String,required:!1,default:"Fail",description:"label for the left swipe button"},rightSwipeLabel:{type:String,required:!1,default:"True",description:"label for the right swipe button"}}},swipeLeft:function(){this.setSwipe("swipe-left"),this.vote(0)},swipeRight:function(){this.setSwipe("swipe-right"),this.vote(1)},onSwipe:function(e){2===e.direction?this.swipeLeft():this.swipeRight()},setSwipe:function(e){this.swipe=e},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),"play"===this.playMode&&(this.showTutorialStep(0),this.showTutorialStep(1),this.showTutorialStep(2)),this.swipeLeft(),this.swipeRight(),this.onSwipe({direction:1}),this.onSwipe({direction:2}),this.setSwipe("swipe-left"),this.getPropertiesSchema(),1}}},ae={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"imageSoundSwipe"},[i("transition",{key:e.swipe,attrs:{name:e.swipe}},[i("div",{key:e.baseUrl,staticClass:"user-card"},[i("div",{staticClass:"image_area",on:{click:e.playSound}},[i("progressive-img",{directives:[{name:"hammer",rawName:"v-hammer:swipe.horizontal",value:e.onSwipe,expression:"onSwipe",arg:"swipe",modifiers:{horizontal:!0}}],staticClass:"user-card__picture mx-auto",attrs:{src:e.baseUrl,placeholder:"https://unsplash.it/500","aspect-ratio":1}})],1),e._v(" "),i("div",{staticClass:"user-card__name"},[e.playMode?i("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowleft"],expression:"['arrowleft']"},{name:"hammer",rawName:"v-hammer:swipe.left",value:e.swipeLeft,expression:"swipeLeft",arg:"swipe",modifiers:{left:!0}}],ref:"leftSwipe",staticStyle:{float:"left"},attrs:{variant:"danger"},on:{click:e.swipeLeft,shortkey:e.swipeLeft}},[i("i",{staticClass:"fa fa-long-arrow-left",attrs:{"aria-hidden":"true"}}),e._v("\n          "+e._s(e.widgetProperties.leftSwipeLabel)+"\n         ")]):i("span",{staticStyle:{float:"left"}},[e.widgetSummary?i("span",[e._v(" ave vote: "+e._s(e.widgetSummary.aveVote||0)+" ")]):i("span",[e._v("ave vote: N/A")])]),e._v(" "),e.playMode?i("b-button",{ref:"helpButton",staticClass:"helpbtn",attrs:{to:"/review/"+e.widgetPointer}},[e._v("Help")]):e._e(),e._v(" "),e.playMode?i("b-button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["arrowright"],expression:"['arrowright']"}],ref:"rightSwipe",staticStyle:{float:"right"},attrs:{variant:"success"},on:{click:e.swipeRight,shortkey:e.swipeRight}},[e._v(" "+e._s(e.widgetProperties.rightSwipeLabel)+"\n          "),i("i",{staticClass:"fa fa-long-arrow-right",attrs:{"aria-hidden":"true"}})]):i("span",{staticStyle:{float:"right"}},[e.widgetSummary?i("span",[e._v(" num votes: "+e._s(e.widgetSummary.count||0)+" ")]):i("span",[e._v("num votes: 0")])])],1)])])],1)},staticRenderFns:[]};var oe=i("VU/8")(ne,ae,!1,function(e){i("4VBG")},"data-v-d00adff4",null).exports,ue={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"bookshelf_wrapper"},[t("ul",{staticClass:"books_list"},[t("li",{staticClass:"book_item first"}),this._v(" "),t("li",{staticClass:"book_item second"}),this._v(" "),t("li",{staticClass:"book_item third"}),this._v(" "),t("li",{staticClass:"book_item fourth"}),this._v(" "),t("li",{staticClass:"book_item fifth"}),this._v(" "),t("li",{staticClass:"book_item sixth"})]),this._v(" "),t("div",{staticClass:"shelf"})])}]};var le=i("VU/8")({name:"bookshelf"},ue,!1,function(e){i("a+Tf")},null,null).exports,ce={name:"PubMedNLP",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{xmlString:"",status:"loading"}},components:{Bookshelf:le},computed:{xml:function(){return(new DOMParser).parseFromString(this.xmlString,"text/xml")},abstract:function(){if(this.xml){var e=this.xml.getElementsByTagName("AbstractText");return p.a.map(e,function(e){return e.innerHTML}).join("\n")}return null},title:function(){if(this.xml){var e=this.xml.getElementsByTagName("ArticleTitle");return p.a.map(e,function(e){return e.innerHTML}).join("\n")}return null},authors:function(){if(this.xml){var e=this.xml.getElementsByTagName("Author");return p.a.map(e,function(e){return e.children[0].innerHTML+", "+e.children[1].innerHTML[0]+"."}).join(", ")}return null},year:function(){return this.xml&&this.xml.getElementsByTagName("Year").length?this.xml.getElementsByTagName("Year")[0].innerHTML:null}},watch:{widgetPointer:function(){this.widgetPointer&&this.getPubmedData()}},mounted:function(){this.widgetPointer&&this.getPubmedData()},methods:{getPubmedData:function(){var e=this;this.status="loading";var t=this.widgetProperties.template||this.getPropertiesSchema().template.default;c.a.get(t.replace("{0}",this.widgetPointer)).then(function(t){e.xmlString=t.data,e.status="ready"})},getScore:function(e){return e?1:0},getFeedback:function(e){return e?{show:!0,variant:"success",message:"good job"}:{show:!0,variant:"danger",message:"bad job"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{template:{type:String,required:!0,description:"pubmed query template",default:"https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=pubmed&id={0}&tool=appstract&email=keshavan@berkeley.edu&retmode=xml"}}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.getPropertiesSchema(),1}}},de={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetTemplate"},["ready"===e.status?i("div",[i("h5",{staticClass:"lead mt-3 pt-3 pb-0 mb-0"},[e._v(e._s(e.title))]),e._v(" "),i("p",{staticClass:"text-justify mb-3 pb-3 mt-1 pt-1"},[e._v(e._s(e.abstract))])]):i("div",[i("Bookshelf")],1),e._v(" "),e.playMode?e._e():i("p",{staticClass:"mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetSummary))]),e._v(" "),e.playMode?i("div",{staticClass:"row"},[i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"danger"},on:{click:function(t){return e.vote(0)}}},[e._v("Vote No")]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"info",to:"/review/"+e.widgetPointer}},[e._v("Help")]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"success"},on:{click:function(t){return e.vote(1)}}},[e._v("Vote Yes")])],1):e._e()])},staticRenderFns:[]};var pe=i("VU/8")(ce,de,!1,function(e){i("MEoe")},null,null).exports;s.default.use(te.a),s.default.use(Q.VueHammer),s.default.use(i("m0IH"));var he={name:"ImageSwipeChoices",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},components:{VueHammer:Q.VueHammer,GridLoader:X},directives:{imagesLoaded:K.a},data:function(){return{status:"loading",swipe:null}},computed:{baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null}},mounted:function(){"tutorial"===this.playMode&&this.showTutorialStep(this.tutorialStep)},methods:{showTutorialStep:function(e){if(e<this.widgetProperties.length){this.widgetProperties.choices[e].id;this.$refs.element.$el.classList.add("focus")}},fillPropertyPattern:function(e,t){var i=e,s=String(this.widgetPointer).split(t);return p.a.map(s,function(e,t){i=i.replace("{"+t+"}",e)}),i},getScore:function(e){return"danger"===this.getFeedback(e).variant?0:1},getFeedback:function(e){var t=void 0;if((t=this.widgetSummary?this.widgetSummary:{count:0}).count>4){var i=t.aveVote;return i>=.7&&!e?{show:!1,variant:"danger",message:"+0 most people swiped right"}:i<=.3&&e?{show:!1,variant:"danger",message:"+0 most people swiped left"}:{show:!0,variant:"success",message:"+1 good job"}}return{show:!0,variant:"success",message:"+1 thanks"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{baseUrlTemplate:{type:String,required:!0,description:"base url to the image file"},delimiter:{type:String,required:!1,default:"__",description:"how to split the sample ID to fill in the template"},choices:{type:Array,required:!0,description:"the different tags for the image",max_length:4,default:[{id:"artifact",name:"Artifact",variant:"danger"},{id:"unknown",name:"Don't know",variant:"info"},{id:"brain",name:"Brain",variant:"success"}],schema:{type:Object,schema:{id:{type:String,required:!0,description:"id of the button"},name:{type:String,required:!0,description:"name of the button"},variant:{type:String,required:!0,description:"color variant of the button"}}}}}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.showTutorialStep(0),this.showTutorialStep(1),this.showTutorialStep(2),this.getPropertiesSchema(),1}}},me={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"imageSwipe"},[i("transition",{key:e.swipe,attrs:{name:e.swipe}},[i("div",{key:e.baseUrl,staticClass:"user-card"},[i("div",{staticClass:"image_area"},[i("progressive-img",{staticClass:"user-card__picture mx-auto",attrs:{src:e.baseUrl,placeholder:"https://unsplash.it/500","aspect-ratio":1}})],1),e._v(" "),i("div",{staticClass:"user-card__name"},e._l(e.widgetProperties.choices,function(t,s){return e.playMode?i("b-button",{key:s,ref:"choice.id",refInFor:!0,attrs:{variant:t.variant},on:{click:function(t){return e.vote(s)}}},[e._v("\n              "+e._s(t.name)+"\n           ")]):e._e()}),1),e._v(" "),i("div",{staticClass:"user-card__name"},[e.playMode?i("b-button",{ref:"helpButton",staticClass:"helpbtn",attrs:{to:"/review/"+e.widgetPointer}},[e._v("Help")]):e._e()],1)])])],1)},staticRenderFns:[]};var ge=i("VU/8")(he,me,!1,function(e){i("F0zZ")},"data-v-0060809c",null).exports,fe={name:"TemplateWidget",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{}},methods:{getScore:function(e){return e?1:0},getFeedback:function(e){return e?{show:!0,variant:"success",message:"good job"}:{show:!0,variant:"danger",message:"bad job"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.getPropertiesSchema(),1}}},ve={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetTemplate"},[i("p",{staticClass:"lead mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetPointer))]),e._v(" "),e.playMode?e._e():i("p",{staticClass:"mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetSummary))]),e._v(" "),e.playMode?i("div",{staticClass:"row"},[i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"danger"},on:{click:function(t){return e.vote(0)}}},[e._v("Vote No")]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"info",to:"/review/"+e.widgetPointer}},[e._v("Help")]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"success"},on:{click:function(t){return e.vote(1)}}},[e._v("Vote Yes")])],1):e._e()])},staticRenderFns:[]};var be=i("VU/8")(fe,ve,!1,function(e){i("i+8Z")},null,null).exports,we=i("vdhV"),ye={name:"TextTagger",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{data:{},tag:"",tags:[],previousTags:[]}},components:{VueTagsInput:i.n(we).a},watch:{widgetPointer:function(){this.getData()}},computed:{baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null},title:function(){return this.data[this.widgetProperties.titleKey]},text:function(){return this.data[this.widgetProperties.textKey]},autocompleteItems:function(){var e=this;return p.a.filter(p.a.map(p.a.uniq(this.widgetProperties.autoComplete.concat(this.previousTags)),function(e){return{text:e}}),function(t){return new RegExp(e.tag,"i").test(t.text)})}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;c.a.get(this.baseUrl).then(function(t){e.data=t.data})},fillPropertyPattern:function(e,t){var i=e,s=String(this.widgetPointer).split(t);return p.a.map(s,function(e,t){i=i.replace("{"+t+"}",e)}),i},getScore:function(e){return e?1:0},getFeedback:function(e){return e?{show:!0,variant:"success",message:"good job"}:{show:!0,variant:"danger",message:"bad job"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(){var e=p.a.map(this.tags,function(e){return e.text});this.$emit("widgetRating",e),this.previousTags=p.a.uniq(this.previousTags.concat(e).concat(this.widgetProperties.autoComplete)),this.tags=[]},getPropertiesSchema:function(){return{}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.getPropertiesSchema(),1}}},_e={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetTemplate pb-3"},[e.playMode?i("div",{staticClass:"bg-light pt-3 pb-3 mb-3 pl-3 pr-3",staticStyle:{left:"0",width:"100%",position:"-webkit-sticky",top:"0"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"pb-2"},[e._v("Tags:")]),e._v(" "),i("div",{staticClass:"row pb-2"},[i("vue-tags-input",{attrs:{tags:e.tags,"autocomplete-items":e.autocompleteItems},on:{"tags-changed":function(t){return e.tags=t}},model:{value:e.tag,callback:function(t){e.tag=t},expression:"tag"}})],1),e._v(" "),e.playMode?i("div",{staticClass:"row"},[i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"info",to:"/review/"+e.widgetPointer}},[e._v("Discuss")]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3",attrs:{variant:"success"},on:{click:e.vote}},[e._v("Submit")])],1):e._e()])]):e._e(),e._v(" "),i("h3",[e._v(e._s(e.title))]),e._v(" "),i("p",{staticClass:"text-left mb-3",staticStyle:{"white-space":"pre-line"},domProps:{innerHTML:e._s(e.text)}})])},staticRenderFns:[]};var Se=i("VU/8")(ye,_e,!1,function(e){i("BcDm")},null,null).exports,ke={props:{config:{type:Object,required:!0}},data:function(){return{widgetOptions:["ImageSwipe","ImageSoundSwipe","ImageSwipeChoices","ImageSplat","PubMedNLP","TemplateWidget","TextTagger"]}},computed:{widgetSchema:function(){return this.getWidgetSchema(this.config.widgetType)}},methods:{getWidgetSchema:function(e){var t=void 0;switch(e){case"ImageSwipe":t=s.default.extend(re);break;case"ImageSoundSwipe":t=s.default.extend(oe);break;case"ImageSwipeChoices":t=s.default.extend(ge);break;case"PubMedNLP":t=s.default.extend(pe);break;case"ImageSplat":t=s.default.extend(G);break;case"TextTagger":t=s.default.extend(Se);break;default:t=s.default.extend(be)}return new t({propsData:{widgetPointer:"",widgetProperties:{},userSettings:{}}}).getPropertiesSchema()}},mounted:function(){this.$router&&this.$router.replace("/play")}},Ce={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("h5",{staticClass:"mt3 pt-3"},[e._v("Widget")]),e._v(" "),i("b-form-select",{staticClass:"mb-3",attrs:{id:"navbarVariant",options:e.widgetOptions},model:{value:e.config.widgetType,callback:function(t){e.$set(e.config,"widgetType",t)},expression:"config.widgetType"}}),e._v(" "),i("h5",{staticClass:"mt3 pt-3"},[e._v("Widget Properties")]),e._v(" "),e._l(e.widgetSchema,function(t,s){return i("div",{staticClass:"mt-2"},[i("label",{attrs:{for:s}},[e._v(e._s(s))]),e._v(" "),""===t.type()?i("div",[i("b-form-input",{attrs:{type:"text",id:s,placeholder:t.default},model:{value:e.config.widgetProperties[s],callback:function(t){e.$set(e.config.widgetProperties,s,t)},expression:"config.widgetProperties[key]"}})],1):Array.isArray(t.type())?i("div",[i("b-alert",{attrs:{show:"",variant:e.danger}},[e._v("Not implemented yet!")])],1):e._e()])})],2)},staticRenderFns:[]};var Pe=i("VU/8")(ke,Ce,!1,function(e){i("GHIx")},null,null).exports,xe={name:"Initializer",props:{config:{type:Object,required:!0},db:{type:Object,required:!0},userInfo:{type:Object,required:!0}},data:function(){return{admin:!1,sampleCounts:!1,sampleSummary:!1,chats:!1,userSeenSamples:!1,userSettings:!1,votes:!1}},computed:{uid:function(){return this.userInfo.uid},ready:function(){return this.admin&&this.sampleCounts&&this.sampleSummary&&this.chats&&this.userSeenSamples&&this.votes&&this.userSettings}},watch:{ready:function(){this.ready&&this.next()}},mounted:function(){this.initAll()},methods:{initAdmin:function(){var e=this,t=this.userInfo.displayName;this.db.ref("settings").child("admins").child(t).set(1),this.db.ref("users").child(t).child("admin").set(!0).then(function(){e.admin=!0})},initSampleCounts:function(){var e=this;this.db.ref("sampleCounts").once("value").then(function(t){null===t.val()&&e.db.ref("sampleCounts").set(0)}).then(function(){e.sampleCounts=!0})},initSampleSummary:function(){var e=this;this.db.ref("sampleSummary").once("value").then(function(t){null===t.val()&&e.db.ref("sampleSummary").set(0)}).then(function(){e.sampleSummary=!0})},initChats:function(){var e=this;this.db.ref("chats").once("value").then(function(t){null===t.val()&&e.db.ref("chats").set(0)}).then(function(){e.chats=!0})},initUserSeenSamples:function(){var e=this,t=this.userInfo.displayName;this.db.ref("userSeenSamples").child(t).once("value").then(function(i){null===i.val()&&e.db.ref("userSeenSamples").child(t).set(0)}).then(function(){e.userSeenSamples=!0})},initVotes:function(){var e=this;this.db.ref("votes").once("value").then(function(t){null===t.val()&&e.db.ref("votes").set(0)}).then(function(){e.votes=!0})},initUserSettings:function(){var e=this;this.db.ref("userSettings").once("value").then(function(t){null===t.val()&&e.db.ref("userSettings").set(0)}).then(function(){e.userSettings=!0})},initAll:function(){this.initAdmin(),this.initSampleCounts(),this.initSampleSummary(),this.initChats(),this.initUserSeenSamples(),this.initUserSettings(),this.initVotes()},next:function(){this.$emit("next")}}},Te={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"text-left ml-3 pl-3"},[i("p",[e._v("Admin: "+e._s(e.admin))]),e._v(" "),i("p",[e._v("sampleCounts: "+e._s(e.sampleCounts))]),e._v(" "),i("p",[e._v("sampleSummary: "+e._s(e.sampleSummary))]),e._v(" "),i("p",[e._v("chats: "+e._s(e.chats))]),e._v(" "),i("p",[e._v("user seen samples: "+e._s(e.userSeenSamples))]),e._v(" "),i("p",[e._v("votes: "+e._s(e.votes))])]),e._v(" "),e.ready?i("b-btn",{on:{click:function(t){return e.next()}}},[e._v("Next")]):e._e()],1)},staticRenderFns:[]};var Ie=i("VU/8")(xe,Te,!1,function(e){i("DBwL")},null,null).exports;var Ue={name:"configuration",props:{config:{type:Object,required:!0},userInfo:{type:Object,required:!0},db:{type:Object,required:!0},configurationState:{type:Object,required:!0}},data:function(){return{fkeys:null,width:300,resizing:!1,configURL:""}},components:{FirebaseKeys:k,App:x,Home:U,Tutorial:L,Widget:Pe,Initializer:Ie},computed:{styleContent:function(){return{width:this.width+"px",position:"fixed",top:0,"z-index":"9",background:"#ffffffe0",height:"100%",padding:"10px","overflow-y":"scroll"}},styleResize:function(){return{left:this.width+"px"}},step:function(){return this.configurationState.step},rules:function(){return'\n      {\n        "rules": {\n          ".read": "auth.uid === \''+this.userInfo.uid+'\'", // replace w/ your UID\n          ".write": "auth.uid === \''+this.userInfo.uid+'\'",// replace w/ your UID\n          "users": {\n            ".read": true,\n            ".write": "auth !== null && data.exists()",\n            "$displayName": {\n              ".read": true,\n              ".write": "$displayName === auth.token.name",\n              "admin": {\n                ".write": "auth.uid === \''+this.userInfo.uid+'\'", // replace w/ your UID\n              }\n            }\n          },\n          "userSettings": {\n            ".read": false,\n            ".write": "auth !== null && data.exists()",\n            "$displayName": {\n              ".read": "$displayName === auth.token.name",\n              ".write": "$displayName === auth.token.name",\n            },\n          },\n          "chats": {\n            ".read": true,\n            ".write": "auth !== null && data.exists()",\n          },\n          "sampleCounts": {\n            ".read": true,\n            ".write": "auth !== null && data.exists()",\n          },\n          "sampleSummary": {\n            ".read": true,\n            ".write": "auth !== null && data.exists()",\n          },\n          "settings": {\n            ".read": true,\n            ".write": "auth.uid === \''+this.userInfo.uid+'\'" // replace w/ your UID\n          },\n          "userSeenSamples": {\n            ".read": true,\n            "$displayName": {\n              ".write": true, // "$displayName === auth.token.name"\n            },\n          },\n          "votes": {\n            ".write": "data.exists()",\n            ".read": "auth !== null",\n          }\n        }\n      }\n      '}},methods:{update:function(){},startResize:function(){this.resizing=!0},resize:function(e){this.resizing&&(this.width=e.clientX)},endResize:function(){this.resizing=!1},close:function(){this.$emit("closeConfig")},setNewFirebaseKeys:function(e){this.config.firebaseKeys=e,this.configurationState.step=1},next:function(){this.configurationState.step+=1},prev:function(){this.configurationState.step-=1},downloadConfig:function(){!function(e,t){var i=document.createElement("a");i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}("config.json",y()(this.config,null,2))}},watch:{userInfo:{handler:function(){this.userInfo.displayName&&this.$forceUpdate()},deep:!0}},mounted:function(){window.addEventListener("mousemove",this.resize),window.addEventListener("mouseup",this.endResize),this.config.needsTutorial=!1},beforeDestroy:function(){window.removeEventListener("mousemove",this.resize),window.removeEventListener("mouseup",this.endResize)}},Fe={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"configuration"},[i("div",{style:e.styleContent},[i("h3",[e._v(" Swipes for Science\n      "),i("button",{staticClass:"close",attrs:{type:"button","aria-label":"Close",id:"closeConfigButton"},on:{click:e.close}},[i("span",{attrs:{"aria-hidden":"true"}},[e._v("")])])]),e._v(" "),i("p",{staticClass:"lead"},[e._v("Configuration")]),e._v(" "),0===e.step?i("FirebaseKeys",{on:{newFirebaseKeys:e.setNewFirebaseKeys}}):e._e(),e._v(" "),1===e.step&&0===Object.keys(e.userInfo).length?i("div",[i("b-alert",{attrs:{show:""}},[e._v("\n        Thanks for your keys!\n        Follow the steps on the video above:\n      ")]),e._v(" "),i("video",{staticClass:"video",attrs:{src:"https://s3.amazonaws.com/hotdognothotdog/setupAuthAndDatabase.webm",controls:""}}),e._v(" "),i("b-alert",{attrs:{show:""}},[e._v("\n        when you're done,\n        "),i("router-link",{attrs:{to:"/login"}},[e._v("log in")]),e._v("\n        or "),i("router-link",{attrs:{to:"/signup"}},[e._v("sign up")]),e._v("\n        to continue with configuration.\n      ")],1)],1):e._e(),e._v(" "),1===e.step&&Object.keys(e.userInfo).length?i("div",[null!==e.userInfo.displayName?i("Initializer",{attrs:{config:e.config,userInfo:e.userInfo,db:e.db},on:{next:e.next}}):i("div",[e._v("Hold on... "+e._s(e.userInfo.displayName))])],1):e._e(),e._v(" "),2===e.step?i("App",{attrs:{config:e.config}}):e._e(),e._v(" "),3===e.step?i("Widget",{attrs:{config:e.config}}):e._e(),e._v(" "),4===e.step?i("Home",{attrs:{config:e.config}}):e._e(),e._v(" "),5===e.step?i("Tutorial",{attrs:{config:e.config}}):e._e(),e._v(" "),6===e.step?i("div",[i("h5",[e._v("Lock down your database!")]),e._v(" "),i("p",[e._v("Copy/paste your rules into your firebase console in the 'rules' tab.")]),e._v(" "),i("textarea",{staticClass:"codeBlock",attrs:{disabled:"",rows:"15"},domProps:{value:e.rules}}),e._v(" "),i("br"),e._v(" "),i("b-button",{attrs:{variant:"primary"}},[e._v("Copy to clipboard")])],1):e._e(),e._v(" "),7===e.step?i("div",[i("p",[e._v(" 1. Download your config file. ")]),e._v(" "),i("b-button",{staticClass:"mb-3",attrs:{variant:"primary"},on:{click:e.downloadConfig}},[e._v("Download")]),e._v(" "),i("p",[e._v(" 2. Upload your config file to the web (e.g S3, GitHub, Gist, etc) ")]),e._v(" "),i("p",[e._v(" 3. Copy/paste the public URL to your config here: ")]),e._v(" "),i("b-input",{model:{value:e.configURL,callback:function(t){e.configURL=t},expression:"configURL"}})],1):e._e(),e._v(" "),8===e.step?i("div",[i("h5",[e._v("Done!")]),e._v(" "),i("p",{staticClass:"lead"},[e._v("\n        The URL to your project is:\n      ")]),e._v(" "),i("p",[i("a",{attrs:{href:"https://dev.swipesforscience.org/#/?config="+e.configURL}},[e._v("\n         https://dev.swipesforscience.org/#/?config="+e._s(e.configURL)+"\n        ")])])]):e._e(),e._v(" "),e.step>=2?i("div",{staticClass:"mt-3 pt-3"},[e.step>=3?i("b-button",{attrs:{variant:"secondary"},on:{click:e.prev}},[e._v(" Prev ")]):e._e(),e._v(" "),e.step<=7?i("b-button",{attrs:{variant:"secondary",disabled:7===e.step&&!e.configURL},on:{click:e.next}},[e._v(" Next ")]):e._e()],1):e._e()],1),e._v(" "),i("div",{style:e.styleResize,attrs:{id:"expander"},on:{mousedown:e.startResize}})])},staticRenderFns:[]};var qe=i("VU/8")(Ue,Fe,!1,function(e){i("UZuB")},"data-v-242c41f4",null).exports,Le={name:"Footer",props:{config:{type:Object,required:!0},routerQuery:{type:Object,required:!0}},data:function(){return{}},methods:{openConfig:function(e){e.preventDefault(),this.$emit("openConfig")}}},Re={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{},[i("div",{staticClass:"footer bg-dark pr-3 pl-3"},[i("div",{staticClass:"container"},[e.config.showConfigure?i("div",{staticClass:"align-middle text-right text-white configureButton"},[i("b-button",{attrs:{variant:"info"},on:{click:e.openConfig}},[i("i",{staticClass:"fa fa-wrench",attrs:{"aria-hidden":"true"}}),e._v(" Configure\n        ")])],1):e._e(),e._v(" "),i("table",{staticStyle:{height:"200px",width:"100%"}},[i("tbody",[i("tr"),e._v(" "),i("tr",[i("td",{staticClass:"align-middle text-center text-white"},[i("router-link",{staticClass:"text-white",attrs:{to:{name:"About",query:e.routerQuery}}},[e._v("About")]),e._v(" "),i("br")],1)]),e._v(" "),i("tr",[i("td",{staticClass:"align-middle text-center text-white"},[e._v("\n          icons on this site are from "),i("a",{attrs:{href:e.config.iconAttribute.url}},[e._v(e._s(e.config.iconAttribute.name))]),e._v("\n          and illustrations are from "),i("a",{attrs:{href:"https://undraw.co"}},[e._v("undraw.co")])])])])])])])])},staticRenderFns:[]};var Ee=i("VU/8")(Le,Re,!1,function(e){i("BQ6R")},"data-v-10f4e401",null).exports;s.default.use(f.a),s.default.use(u.a),window.firebase=n.a;var Me={name:"app",data:function(){return{userInfo:{},db:n.a.database(),config:b,showConfig:!1,allUsers:[],configurationState:{step:0}}},mounted:function(){m.a.init(),this.userInfo=n.a.auth().currentUser;var e=this;n.a.auth().onAuthStateChanged(function(t){e.userInfo=t||{}})},components:{Configure:qe,Footer:Ee},firebase:function(){return{allUsers:{source:this.db.ref("/users/").orderByChild("score"),asObject:!0}}},watch:{firebaseKeys:function(e){var t=this;n.a.auth().signOut().then(function(){t.userInfo={},n.a.app().delete().then(function(){n.a.initializeApp(e),t.db=n.a.database(),t.db.ref("/users/").orderByChild("score").on("value",function(e){t.allUsers=e.val()}),t.userInfo=n.a.auth().currentUser||{};var i=t;n.a.auth().onAuthStateChanged(function(e){i.userInfo=e||{}})})})}},computed:{firebaseKeys:function(){return this.config.firebaseKeys},brandName:function(){return this.config.home.title},betaMode:function(){return this.config.betaMode},needsTutorial:function(){return this.config.needsTutorial},navbarVariant:function(){return this.config.app&&this.config.app.navbarVariant||"info"},userData:function(){var e=this,t={};return null==this.userInfo?t:o()(this.userInfo).length?(p.a.map(this.allUsers,function(i,s){s===e.userInfo.displayName&&((t=i)[".key"]=s)}),t):t},levels:function(){return this.config.levels},currentLevel:function(){var e=this,t={};return p.a.mapValues(this.levels,function(i){e.userData.score>=i.min&&e.userData.score<=i.max&&(t=i)}),t},userIsDefined:function(){return null!=this.userInfo&&o()(this.userInfo).length},routerQuery:function(){return this.$route.query}},methods:{logout:function(){var e=this;n.a.auth().signOut().then(function(){e.userInfo={},e.$router.replace("login")})},setUser:function(e){this.userInfo=e||{}},setTutorial:function(e){this.db.ref("/users/"+this.userInfo.displayName).child("taken_tutorial").set(e),this.$router.replace("play")},openConfig:function(){this.showConfig=!0},closeConfig:function(){this.showConfig=!1}},created:function(){var e=this;this.$route.query.config&&c.a.get(this.$route.query.config).then(function(t){e.config=t.data}).catch(function(){})}},je={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"content"},[e.betaMode?i("div",{staticClass:"corner-ribbon bottom-right sticky blue"},[e._v("Beta")]):e._e(),e._v(" "),i("b-navbar",{attrs:{toggleable:"md",type:"dark",variant:e.navbarVariant}},[i("b-navbar-toggle",{attrs:{target:"nav_collapse"}}),e._v(" "),i("b-navbar-brand",{attrs:{to:"/",id:"brandName"}},[e._v(e._s(e.brandName))]),e._v(" "),i("b-collapse",{attrs:{"is-nav":"",id:"nav_collapse"}},[i("b-navbar-nav",{attrs:{id:"navLinks"}},[i("b-nav-item",{attrs:{to:{name:"Home",query:e.routerQuery},exact:""}},[e._v("Home")]),e._v(" "),i("b-nav-item",{attrs:{to:{name:"Leaderboard",query:e.routerQuery}}},[e._v("Leaderboard")]),e._v(" "),i("b-nav-item",{attrs:{to:{name:"Play",query:e.routerQuery}}},[e._v("Play")]),e._v(" "),i("b-nav-item",{attrs:{to:{name:"Chats",query:e.routerQuery}}},[e._v("Chats")]),e._v(" "),e.needsTutorial?i("b-nav-item",{attrs:{to:{name:"Tutorial",query:e.routerQuery}}},[e._v("Tutorial")]):e._e(),e._v(" "),e.userData.admin?i("b-nav-item",{attrs:{to:{name:"Admin",query:e.routerQuery}}},[e._v("Admin")]):e._e()],1),e._v(" "),i("b-navbar-nav",{staticClass:"ml-auto"},[e.userIsDefined?i("b-nav-item-dropdown",{attrs:{right:""}},[i("template",{slot:"button-content"},[i("em",[e._v(e._s(e.userInfo.displayName))])]),e._v(" "),i("b-dropdown-item",{attrs:{to:{name:"Profile",query:e.routerQuery}}},[e._v("Profile")]),e._v(" "),i("b-dropdown-item",{on:{click:e.logout}},[e._v("Signout")])],2):i("b-nav-item",{attrs:{to:{name:"Login",query:e.routerQuery}}},[e._v("Login")]),e._v(" "),e.userIsDefined?i("b-nav-text",[e.currentLevel.img?i("b-img",{staticClass:"m-1",attrs:{rounded:"circle",width:"20",height:"20",alt:"img",src:e.currentLevel.img}}):e._e(),e._v("\n          "+e._s(e.userData.score)+"\n        ")],1):e._e()],1)],1)],1),e._v(" "),i("div",{staticClass:"router"},[i("router-view",{attrs:{userInfo:e.userInfo,userData:e.userData,allUsers:e.allUsers,levels:e.levels,currentLevel:e.currentLevel,config:e.config,db:e.db,routerQuery:e.routerQuery},on:{taken_tutorial:e.setTutorial}})],1),e._v(" "),e.showConfig?i("Configure",{ref:"configurationPane",attrs:{config:e.config,userInfo:e.userInfo,db:e.db,configurationState:e.configurationState},on:{closeConfig:e.closeConfig}}):e._e()],1),e._v(" "),i("Footer",{attrs:{config:e.config,routerQuery:e.routerQuery},on:{openConfig:e.openConfig}})],1)},staticRenderFns:[]};var De=i("VU/8")(Me,je,!1,function(e){i("Jjjm")},null,null).exports,Oe=i("/ocq"),$e={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"about"}},[i("h1",[e._v(" About braindrles. ")]),e._v(" "),i("b-container",[i("p",[e._v("Braindrles is an app to help researchers understand stroke better. Here, were asking you to help us check whether computer algorithms have correctly identified stroke lesions on brain images. To do this on our own would take years! \n    ")]),e._v(" "),i("h2",[e._v(" What do I do? ")]),e._v(" "),i("p",[e._v(" You will see flashing pictures of stroke lesion masks on brain MRIs. If you believe that the stroke lesion mask correctly captures the lesioned part of the brain, you swipe right. If you believe the mask is wrong, swipe left. Youll get points for each image you rate. Occasionally, ground truth images are hidden in the database, and you will receive feedback if you make the wrong choice so over time you can learn what a stroke lesion looks like. \n    ")]),e._v(" "),i("h2",[e._v(" Why are we doing this? ")]),e._v(" "),i("p",[e._v(" Manual segmentation (e.g., going through each slice of the brain and tracing the outline of the lesion) is the gold standard for lesion analyses; however, this approach is extremely time consuming and requires expertise in neuroanatomy. Emerging big data approaches for stroke rehabilitation research requires analyzing hundreds to thousands of stroke MRIs. A fast, effective, and scalable pipeline for lesion analysis is thus desperately needed. ")]),e._v(" "),i("h2",[e._v(" How you are helping? ")]),e._v(" "),i("p",[e._v(" Although all data can be quickly run through lesion segmentation algorithms, they arent perfect at how they segment lesions, and sometimes do a really bad job. We need humans to visually inspect the quality of these machine-driven outputs. Computers really struggle to do this sort of thing, but humans are great at it. That's why we need you! We need you to help researchers learn about stroke better! ")]),e._v(" "),i("h3",[e._v(" You can unlock the following animals based on the number of points you have. Go unlock them all!! Who doesn't want to be a unicorn  ? ")]),e._v(" "),i("b-container",{staticClass:"p-4",attrs:{fluid:""}},[i("b-row",e._l(e.levels,function(t){return t.img?i("b-col",[i("div",[i("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img_grey,alt:"Thumbnail"}}),e._v(" "),i("br"),e._v("\n            Level "+e._s(t.level)+"\n            "),i("br"),e._v(" "),i("span",[e._v(e._s(t.min)+" points")])],1)]):e._e()}),1)],1)],1)],1)},staticRenderFns:[]};var Ve=i("VU/8")({name:"about",data:function(){return{count:1}},props:["levels"]},$e,!1,function(e){i("eNLd")},null,null).exports,Ne=i("fJom"),Ae=i.n(Ne),ze={name:"admin",data:function(){return{status:"loading...",progress:0,manifestEntries:[],sampleCounts:[],pubmedQueryStore:{},continuation:null}},props:{levels:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},mounted:function(){this.addFirebaseListener()},computed:{manifestType:function(){var e=null;return e=this.config.manifestType?this.config.manifestType:"json",e}},methods:{addFirebaseListener:function(){var e=this;this.db.ref("sampleCounts").once("value",function(t){e.sampleCounts=p.a.map(t.val(),function(e,t){return{".key":t,".value":e}}),e.status="complete"})},xmlParser:function(e){return(new DOMParser).parseFromString(e,"text/xml")},getPubmedQueryPreview:function(){var e=this,t="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pubmed&term="+encodeURI(this.config.manifestQuery)+"&usehistory=y&retmax=100";return c.a.get(t).then(function(t){var i=e.xmlParser(t.data),s=i.getElementsByTagName("WebEnv")[0],r=i.getElementsByTagName("Count")[0],n=i.getElementsByTagName("IdList")[0].children;e.pubmedQueryStore.webEnv=s.innerHTML,e.pubmedQueryStore.count=r.innerHTML,e.manifestEntries=p.a.map(n,function(e){return e.innerHTML})})},getPubmedQueryFull:function(){var e=this;if(this.pubmedQueryStore.webEnv){var t="https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pubmed&term="+encodeURI(this.config.manifestQuery)+"&usehistory=y&retmax="+this.pubmedQueryStore.count+"&WebEnv="+this.pubmedQueryStore.webEnv;c.a.get(t).then(function(t){var i=e.xmlParser(t.data).getElementsByTagName("IdList")[0].children;e.manifestEntries=p.a.map(i,function(e){return e.innerHTML}),e.syncEntries()})}else this.getPubmedQueryPreview().then(function(){e.getPubmedQueryFull()})},getGithubManifest:function(){var e=this,t="https://api.github.com/repos/"+this.config.manifestGitHub.user+"/";return t+=this.config.manifestGitHub.repo+"/contents/"+this.config.manifestGitHub.path,c.a.get(t).then(function(t){e.manifestEntries=p.a.map(t.data,function(e){return e.name.split(".")[0]})})},parseS3:function(e){var t=this,i=this.xmlParser(e),s=i.getElementsByTagName("Key"),r=i.getElementsByTagName("NextContinuationToken"),n=i.getElementsByTagName("IsTruncated")[0].innerHTML;this.continuation="true"===n?encodeURIComponent(r[0].innerHTML):null;var a=p.a.map(s,function(e){return e.innerHTML}),o=p.a.filter(a,function(e){return e.replace(t.config.manifestS3.prefix+"/","")});return p.a.map(o,function(e){return e.replace(t.config.manifestS3.prefix+"/","").split(".")[0]})},S3Continuation:function(e){var t=this,i=this.getS3URL();return e?c.a.get(i).then(function(e){var i=t.parseS3(e.data);t.manifestEntries=p.a.uniq(t.manifestEntries.concat(i)),t.continuation&&t.S3Continuation(t.continuation)}):0},getS3URL:function(e){var t="";return this.config.manifestS3.bucketURL?t=this.config.manifestS3.bucketURL:(t="https://s3-us-west-2.amazonaws.com/"+this.config.manifestS3.bucket+"/?list-type=2&",t+="prefix="+this.config.manifestS3.prefix+"/&max-keys="+this.config.manifestS3.max_keys,t+="&delimiter="+this.config.manifestS3.delimiter),e&&(t+="&continuation-token="+e),t},getS3Manifest:function(){var e=this,t=this.getS3URL();return c.a.get(t).then(function(t){var i=e.parseS3(t.data);e.manifestEntries=p.a.uniq(e.manifestEntries.concat(i)),e.continuation&&e.S3Continuation(e.continuation)})},previewManifest:function(){var e=this;"json"===this.manifestType?c.a.get(this.config.manifestUrl).then(function(t){e.manifestEntries=t.data}):"pubmed"===this.manifestType?this.getPubmedQueryPreview():"github"===this.manifestType?this.getGithubManifest():"S3"===this.manifestType&&this.getS3Manifest()},refreshSamples:function(){var e=this;this.status="refreshing","json"===this.manifestType?c.a.get(this.config.manifestUrl).then(function(t){var i=t.data;e.manifestEntries=i,e.syncEntries()}):"pubmed"===this.manifestType?this.getPubmedQueryFull():"github"===this.manifestType?this.getGithubManifest().then(function(){e.syncEntries()}):"S3"===this.manifestType&&(this.manifestEntries.length?this.syncEntries():(alert("please press the preview button first, and wait to get the final count"),this.status="complete"))},syncEntries:function(){var e=this,t=p.a.map(this.sampleCounts,function(e){return e[".key"]}),i=this,s=new Ae.a;s.postMessage([this.manifestEntries,t,i.config.firebaseKeys]),s.onmessage=function(e){i.status="complete","done"===e.data?i.addFirebaseListener():i.progress+=1},p.a.map(t,function(t){e.manifestEntries.indexOf(t)<0&&e.db.ref("sampleCounts").child(t).remove()})}}},He={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"admin"}},[i("h1",[e._v(" Admin ")]),e._v(" "),i("b-container",["complete"==e.status?i("p",{staticClass:"lead"},[e._v("You have "+e._s(e.sampleCounts.length)+" items currently")]):e._e(),e._v(" "),"json"===e.manifestType?i("p",[i("b",[e._v("Data Source:")]),e._v(" "),i("a",{attrs:{href:e.config.manifestUrl}},[e._v(e._s(e.config.manifestUrl))])]):"pubmed"===e.manifestType?i("p",[i("b",[e._v("Pubmed Query:")]),e._v("\n      "+e._s(e.config.manifestQuery)+"\n    ")]):"github"===e.manifestType?i("p",[i("b",[e._v("Github User:")]),e._v("\n      "+e._s(e.config.manifestGitHub.user)+"\n      "),i("br"),e._v(" "),i("b",[e._v("Github Repo:")]),e._v("\n      "+e._s(e.config.manifestGitHub.repo)+"\n      "),i("br"),e._v(" "),i("b",[e._v("Github Path:")]),e._v("\n      "+e._s(e.config.manifestGitHub.path)+"\n      "),i("br")]):"S3"===e.manifestType?i("p",[i("b",[e._v("S3 bucket:")]),e._v("\n      "+e._s(e.config.manifestS3.bucket)+"\n      "),i("br"),e._v(" "),i("b",[e._v("prefix:")]),e._v("\n      "+e._s(e.config.manifestS3.prefix)+"\n      "),i("br"),e._v(" "),i("b",[e._v("delimiter:")]),e._v("\n      "+e._s(e.config.manifestS3.delimiter)+"\n      "),i("br")]):e._e(),e._v(" "),i("b-button",{attrs:{variant:"warning"},on:{click:e.previewManifest}},[i("span",[e._v(" Preview ")])]),e._v(" "),e.manifestEntries.length?i("div",{staticClass:"mt-3 pt-3"},["json"===e.manifestType?i("small",[e._v("\n        Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total\n      ")]):"pubmed"===e.manifestType?i("small",[e._v("\n        Here are a few pubmed IDs from your search. There are "+e._s(e.pubmedQueryStore.count)+" items in total.\n      ")]):e._e(),e._v(" "),"github"===e.manifestType?i("small",[e._v("\n        Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total\n      ")]):e._e(),e._v(" "),"S3"===e.manifestType?i("small",[e._v("\n        Here are a few items in your manifest file. There are "+e._s(e.manifestEntries.length)+" items in total\n      ")]):e._e(),e._v(" "),i("textarea",{staticClass:"mt-3 mb-3 ml-3 mr-3 w-100",attrs:{disabled:"",rows:"5"},domProps:{value:e.manifestEntries.slice(0,100)+"..."}})]):e._e(),e._v(" "),"complete"==e.status?i("p",{staticClass:"mt-3 pt-3"},[e._v("Click the button below to sync your firebase database with your manifest.")]):e._e(),e._v(" "),i("div",{staticClass:"mb-3 pb-3"},["complete"==e.status?i("b-button",{on:{click:e.refreshSamples}},[i("span",[e._v(" Refresh Sample List ")])]):i("div",[i("p",[e._v(e._s(e.status)+" "+e._s(e.progress)+" / "+e._s(e.manifestEntries.length))]),e._v(" "),i("b-progress",{staticClass:"mb-2",attrs:{value:e.progress,max:e.manifestEntries.length,variant:"info",striped:""}})],1)],1)],1)],1)},staticRenderFns:[]};var Be=i("VU/8")(ze,He,!1,function(e){i("HyhV")},null,null).exports,We={name:"Home",props:{config:{type:Object,required:!0},routerQuery:{type:Object}},data:function(){return{}},computed:{title:function(){return this.config.home.title},tagline:function(){return this.config.home.tagline},landingStyle:function(){return{"background-image":'url("'+this.config.home.backgroundUrl+'")'}}}},Ge={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home container"},[i("div",{staticClass:"jumbotron landing",style:e.landingStyle},[i("h1",[e._v(e._s(e.title))]),e._v(" "),i("p",{staticClass:"lead buttons mt-3"},[e._v("\n      "+e._s(e.tagline)+"\n    ")]),e._v(" "),i("p",{staticClass:"buttons mt-3"},[i("router-link",{staticClass:"btn btn-primary white",attrs:{to:{name:"Play",query:e.routerQuery}}},[e._v(" Play Now ")])],1)])])},staticRenderFns:[]};var Qe=i("VU/8")(We,Ge,!1,function(e){i("rx1Z")},"data-v-a71c4c44",null).exports,Ye={name:"profile",data:function(){return{chats:[],chatInfo:{}}},computed:{blankImage:function(){return this.config.profile.blankImage}},props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},mounted:function(){this.userData[".key"]&&this.getUserChats()},watch:{userData:function(){this.userData[".key"]&&this.getUserChats()},chats:function(){var e=this;this.chats.forEach(function(t){e.db.ref("chats").child("sampleChats").child(t).orderByKey().limitToLast(1).on("value",function(i){var s=i.val();e.chatInfo[t]=s[o()(s)[0]],e.getNotifications(t),e.$forceUpdate()})})}},methods:{getUserChats:function(){var e=this;this.db.ref("chats").child("userChat").child(this.userData[".key"]).on("value",function(t){var i=t.val();i&&(e.chats=o()(i))})},getNotifications:function(e){var t=this;this.db.ref("notifications").child(this.userData[".key"]).child(e).on("value",function(i){i.val()&&(t.chatInfo[e].notify=!0,t.$forceUpdate())})}}},Ke={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"profile"}},[i("b-container",{attrs:{fluid:""}},[i("h1",[e.currentLevel.img?i("b-img",{staticClass:"m-1",attrs:{rounded:"circle",width:"75",height:"75","blank-color":"#777",alt:"img",src:e.currentLevel.img}}):e._e(),e._v("\n      "+e._s(e.userInfo.displayName)+"\n    ")],1),e._v(" "),i("p",{staticClass:"lead"},[e._v("\n      You have "+e._s(e.userData.score)+" points!\n    ")]),e._v(" "),i("hr"),e._v(" "),i("h3",[e._v("Level "+e._s(e.currentLevel.level))]),e._v(" "),i("p",{staticClass:"lead"},[e._v("\n      Keep playing to unlock the remaining animals!\n    ")]),e._v(" "),i("b-container",{staticClass:"p-4",attrs:{fluid:""}},[i("b-row",e._l(e.levels,function(t){return t.img?i("b-col",{key:t.min},[i("div",[t.level<=e.currentLevel.level?i("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img,alt:"Thumbnail"}}):i("b-img",{staticClass:"pokemon",attrs:{fluid:"",src:t.img_grey,alt:"Thumbnail"}}),e._v(" "),i("br"),e._v("\n            Level "+e._s(t.level)+"\n            "),i("br"),e._v(" "),t.level>e.currentLevel.level?i("span",[e._v(e._s(t.min)+" points")]):e._e()],1)]):e._e()}),1)],1),e._v(" "),i("hr"),e._v(" "),e.chats.length?i("div",[i("h2",[e._v(" Your Chats ")]),e._v(" "),i("p",{staticClass:"lead"},[e._v("\n        Your discussions on specific samples\n      ")]),e._v(" "),e._l(e.chats,function(t){return i("div",{key:t,staticClass:"text-left"},[e.chatInfo[t]?i("div",[i("b-alert",{attrs:{show:e.chatInfo[t].notify}},[i("router-link",{attrs:{to:"/listen/"+t}},[e._v(e._s(t))]),e._v(":\n            "),i("b",[e._v(e._s(e.chatInfo[t].username))]),e._v("\n            "+e._s(e.chatInfo[t].message)+"\n          ")],1),e._v(" "),i("b-alert",{attrs:{show:!e.chatInfo[t].notify,variant:"light"}},[i("router-link",{attrs:{to:"/review/"+t}},[e._v(e._s(t))]),e._v(":\n            "),i("b",[e._v(e._s(e.chatInfo[t].username))]),e._v("\n            "+e._s(e.chatInfo[t].message)+"\n          ")],1)],1):e._e()])})],2):i("div",[i("h2",[e._v(" Chats ")]),e._v(" "),i("p",{staticClass:"lead"},[e._v("\n        You haven't said anything yet! When you're ready, join the discussion.\n      ")]),e._v(" "),i("img",{staticClass:"blankImage",attrs:{src:e.blankImage}})])],1)],1)},staticRenderFns:[]};var Ze=i("VU/8")(Ye,Ke,!1,function(e){i("EKwT")},null,null).exports,Je=i("Dd8w"),Xe=i.n(Je),et={name:"BranchingTemplateWidget",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{currentStage:0,response:{}}},components:{},computed:{stages:function(){return this.widgetProperties.stages}},watch:{widgetPointer:function(){this.currentStage=0,this.response={}}},methods:{saveResponse:function(e){this.response[this.stages[this.currentStage].id]=e,this.evaluateStage()&&this.vote(this.response)},evaluateStage:function(){var e=this,t=[],i=[];return p.a.map(this.stages,function(s,r){o()(e.response).indexOf(s.id)>-1?t.push(r):e.testShowCriteria(s)&&i.push(r)}),i.length?(this.currentStage=i[0],0):1},testShowCriteria:function(e){if(p.a.isEmpty(e.showCriteria))return!0;var t=e.showCriteria.statement,i=this.response[e.showCriteria.node],s=e.showCriteria.value;switch(t){case"==":return i===s;case">=":return i>=s;case"<=":return i<=s;case"!=":return i!==s;default:return 0}},updateUserSettings:function(e){this.$emit("updateUserSettings",e)},getScore:function(e){return e?1:0},getFeedback:function(e){return e?{show:!0,variant:"success",message:"good job"}:{show:!0,variant:"danger",message:"bad job"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e),window.scrollTo(0,0)},getPropertiesSchema:function(){return{}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.getPropertiesSchema(),1}}},tt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetTemplate"},[i("b-card",{staticClass:"mb-3 stuck"},[i("transition",{attrs:{name:"fadeOne",mode:"out-in"}},[i("h3",{key:e.widgetProperties.stages[e.currentStage].question,staticClass:"smalltitle mb-3 pb-3 mt-3 pt-3"},[e._v("\n        "+e._s(e.widgetProperties.stages[e.currentStage].question)+"\n      ")])])],1),e._v(" "),i("WidgetSelector",{attrs:{widgetType:e.widgetProperties.stages[e.currentStage].responseProperties.widgetType,widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties.stages[e.currentStage].responseProperties.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,playMode:e.playMode},on:{widgetRating:e.saveResponse,updateUserSettings:e.updateUserSettings}}),e._v(" "),e.playMode?e._e():i("p",{staticClass:"mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetSummary))])],1)},staticRenderFns:[]};var it=i("VU/8")(et,tt,!1,function(e){i("5pvD")},"data-v-0878127c",null).exports,st={name:"TextBinarySwipe",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{data:{},tag:"",tags:[],previousTags:[]}},components:{},watch:{widgetPointer:function(){this.getData()}},computed:{baseUrl:function(){return this.widgetProperties.baseUrlTemplate&&this.widgetPointer?this.fillPropertyPattern(this.widgetProperties.baseUrlTemplate,this.widgetProperties.delimiter):null},title:function(){return this.data[this.widgetProperties.titleKey]},text:function(){return this.data[this.widgetProperties.textKey]},autocompleteItems:function(){var e=this;return p.a.filter(p.a.map(p.a.uniq(this.widgetProperties.autoComplete.concat(this.previousTags)),function(e){return{text:e}}),function(t){return new RegExp(e.tag,"i").test(t.text)})}},mounted:function(){this.getData()},methods:{getData:function(){var e=this;c.a.get(this.baseUrl).then(function(t){e.data=t.data})},fillPropertyPattern:function(e,t){var i=e,s=String(this.widgetPointer).split(t);return p.a.map(s,function(e,t){i=i.replace("{"+t+"}",e)}),i},getScore:function(e){return e?1:0},getFeedback:function(e){return e?{show:!0,variant:"success",message:"good job"}:{show:!0,variant:"danger",message:"bad job"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.getPropertiesSchema(),1}}},rt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetTemplate pb-3"},[e.playMode?i("div",{staticClass:"bg-light pt-3 pb-3 pl-3 pr-3 choicemenu"},[i("div",{staticClass:"container"},[e.playMode?i("div",{staticClass:"row"},[i("b-btn",{staticClass:"mx-auto ml-3 mr-3 bigbutton",attrs:{size:"lg",variant:"danger"},on:{click:function(t){return e.vote(0)}}},[e._v("\n          "+e._s(e.widgetProperties.leftSwipeLabel)+"\n        ")]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3 bigbutton",attrs:{size:"lg",variant:"success"},on:{click:function(t){return e.vote(1)}}},[e._v("\n          "+e._s(e.widgetProperties.rightSwipeLabel)+"\n        ")])],1):e._e(),e._v(" "),i("div")])]):e._e(),e._v(" "),i("transition",{attrs:{name:"fadeOne",mode:"out-in"}},[i("h4",{key:e.title},[e._v(e._s(e.title))])]),e._v(" "),i("transition",{attrs:{name:"fadeOne",mode:"out-in"}},[i("p",{key:e.text,staticClass:"text-left mb-3",staticStyle:{"white-space":"pre-line"},domProps:{innerHTML:e._s(e.text)}})]),e._v(" "),i("b-btn",{staticClass:"mx-auto ml-3 mr-3 mb-3 mt-3",attrs:{size:"sm",variant:"info",to:"/review/"+e.widgetPointer}},[e._v("\n    Not sure? Discuss!\n  ")])],1)},staticRenderFns:[]};var nt=i("VU/8")(st,rt,!1,function(e){i("qVDn")},null,null).exports,at={name:"TemplateWidget",props:{widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},userSettings:{type:Object,required:!0},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1}},data:function(){return{}},methods:{getScore:function(e){return e?1:0},getFeedback:function(e){return e?{show:!0,variant:"success",message:"good job"}:{show:!0,variant:"danger",message:"bad job"}},getSummary:function(e){if(!this.widgetSummary)return{aveVote:e,count:1};var t=this.widgetSummary.aveVote*this.widgetSummary.count+e;return{aveVote:t/=this.widgetSummary.count+1,count:this.widgetSummary.count+1}},vote:function(e){this.$emit("widgetRating",e)},getPropertiesSchema:function(){return{}},test:function(){return this.getScore(1),this.getScore(0),this.getFeedback(1),this.getFeedback(0),this.getSummary(1),this.getSummary(0),this.vote(1),this.getPropertiesSchema(),1}}},ot={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetTemplate"},[i("h1",[e._v("Ratings NHA")]),e._v(" "),i("p",{staticClass:"lead mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetPointer))]),e._v(" "),e.playMode?e._e():i("p",{staticClass:"mb-3 pb-3 mt-3 pt-3"},[e._v(e._s(e.widgetSummary))]),e._v(" "),e.playMode?i("div",{staticClass:"row"},[i("div",[e._v("Computational Slider")]),e._v(" "),i("div",[e._v("Neuroscience Slider")]),e._v(" "),i("div",[e._v("Statement Slider")]),e._v(" "),i("div",[e._v("Submit Button")]),e._v(" "),i("div",[e._v("Skip/Conflict of interest Button")])]):e._e()])},staticRenderFns:[]};var ut=i("VU/8")(at,ot,!1,function(e){i("i3eD")},null,null).exports,lt={name:"SecretWidget",props:{userSettings:{type:Object,required:!0},needsSecret:{type:Boolean,required:!1,default:!1},serverSecret:{type:String,required:!1}},data:function(){return{form:{secret:null}}},computed:{passesSecret:function(){return this.needsSecret&&this.userSettings.secret?btoa(this.userSettings.secret)===this.serverSecret:!this.needsSecret}},methods:{onSubmit:function(e){e.preventDefault();var t=Xe()({},this.userSettings);t.secret=this.form.secret,this.$emit("updateUserSettings",t)}}},ct={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"widgetSecret"},[!e.passesSecret&&e.needsSecret?i("div",{staticClass:"mx-auto",attrs:{id:"signupForm"}},[e.userSettings.secret?i("div",[i("b-alert",{attrs:{variant:"danger",show:""}},[e._v("\n        Oh no! You didn't enter the right secret! Try again.\n      ")])],1):e._e(),e._v(" "),i("p",{staticClass:"lead mb-3 pb-3 mt-3 pt-3"},[i("b-form",{on:{submit:e.onSubmit}},[i("b-form-group",{attrs:{id:"secretInputGroup",label:"Secret:","label-for":"secret"}},[i("b-form-input",{attrs:{id:"secret",type:"text",required:"",placeholder:"Enter Secret"},model:{value:e.form.secret,callback:function(t){e.$set(e.form,"secret",t)},expression:"form.secret"}})],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary"},on:{click:e.onSubmit}},[e._v("Submit")])],1)],1)]):e.passesSecret||!e.needsSecret?i("div",[e._t("default")],2):e._e()])},staticRenderFns:[]};var dt=i("VU/8")(lt,ct,!1,function(e){i("nLH/")},null,null).exports,pt={name:"WidgetSelector",props:{widgetType:{type:String,required:!0},widgetPointer:{type:String,required:!0},widgetProperties:{type:Object,required:!0},userSettings:{type:Object,required:!0},widgetSummary:{type:Object,required:!1},playMode:{type:String,required:!1},tutorialStep:{type:Number,required:!1},needsSecret:{type:Boolean,required:!1},serverSecret:{type:String,required:!1}},components:{ImageSwipe:re,ImageSoundSwipe:oe,PubMedNLP:pe,TemplateWidget:be,ImageSplat:G,ImageSwipeChoices:ge,TextTagger:Se,BranchingTemplateWidget:it,TextBinarySwipe:nt,EvalNHA:ut,Secret:dt},methods:{getFeedback:function(e,t){return this.$refs[this.widgetType].getFeedback(e,t)},showFeedbackModal:function(e){this.$refs[this.widgetType].showFeedbackModal(e)},getScore:function(e,t){return this.$refs[this.widgetType].getScore(e,t)},getSummary:function(e){return this.$refs[this.widgetType].getSummary(e)},widgetRating:function(e){this.$emit("widgetRating",e)},updateUserSettings:function(e){this.$emit("updateUserSettings",e)}}},ht={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"WidgetSelector"},[i("Secret",{attrs:{userSettings:e.userSettings,needsSecret:e.needsSecret,serverSecret:e.serverSecret},on:{updateUserSettings:e.updateUserSettings}},["ImageSwipe"==e.widgetType?i("ImageSwipe",{ref:"ImageSwipe",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):"ImageSoundSwipe"==e.widgetType?i("ImageSoundSwipe",{ref:"ImageSoundSwipe",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):"PubMedNLP"==e.widgetType?i("PubMedNLP",{ref:"PubMedNLP",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):"ImageSplat"==e.widgetType?i("ImageSplat",{ref:"ImageSplat",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):"TextTagger"==e.widgetType?i("TextTagger",{ref:"TextTagger",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):"ImageSwipeChoices"==e.widgetType?i("ImageSwipeChoices",{ref:"ImageSwipeChoices",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):"BranchingTemplateWidget"==e.widgetType?i("BranchingTemplateWidget",{ref:"BranchingTemplateWidget",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):"TextBinarySwipe"==e.widgetType?i("TextBinarySwipe",{ref:"TextBinarySwipe",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):"EvalNHA"==e.widgetType?i("EvalNHA",{ref:"EvalNHAWidget",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}}):i("TemplateWidget",{ref:"TemplateWidget",attrs:{widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,userSettings:e.userSettings,widgetSummary:e.widgetSummary,tutorialStep:e.tutorialStep,playMode:e.playMode},on:{widgetRating:e.widgetRating,updateUserSettings:e.updateUserSettings}})],1)],1)},staticRenderFns:[]};var mt=i("VU/8")(pt,ht,!1,function(e){i("m0XO")},null,null).exports,gt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"flask"}},[i("div",{staticClass:"background"}),e._v(" "),i("svg",{attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 113 130","xml:space":"preserve"}},[i("g",[i("path",{attrs:{fill:"#FFFFFF",d:"M0,0v130h112.084L111.75,0H0z M94.75,128C71,128,56,128,56,128s-14.873,0-38.623,0s-13.945-19.422-6.33-35.945S40,41.25,40,41.25V3h16h11v38.25c0,0,23.901,34.283,31.517,50.805S118.5,128,94.75,128z"}}),e._v(" "),i("path",{attrs:{fill:"none",stroke:"#000000","stroke-width":"3","stroke-miterlimit":"10",d:"M56,127.5c0,0-14.873,0-38.623,0s-13.695-19.172-6.08-35.695C18.912,75.283,40.5,41.25,40.5,41.25V2.5h-9H56h19.5h-8v38.75c0,0,23.651,34.033,31.267,50.555c7.615,16.523,19.733,35.695-4.017,35.695S56,127.5,56,127.5z"}})])]),e._v(" "),i("div",{staticClass:"bubble b0"}),e._v(" "),i("div",{staticClass:"bubble b1"}),e._v(" "),i("div",{staticClass:"bubble b2"}),e._v(" "),i("div",{staticClass:"bubble b3"}),e._v(" "),i("div",{staticClass:"bubble b4"}),e._v(" "),i("div",{staticClass:"bubble b5"}),e._v(" "),i("div",{staticClass:"bubble b6"}),e._v(" "),i("div",{staticClass:"bubble b7"}),e._v(" "),i("div",{staticClass:"bubble b8"}),e._v(" "),i("div",{staticClass:"bubble b9"}),e._v(" "),i("div",{staticClass:"swirl s0"}),e._v(" "),i("div",{staticClass:"swirl s1"}),e._v(" "),i("div",{staticClass:"swirl s2"}),e._v(" "),i("div",{staticClass:"swirl s3"}),e._v(" "),i("div",{staticClass:"swirl s4"}),e._v(" "),i("div",{staticClass:"swirl s5"})])},staticRenderFns:[]};var ft=i("VU/8")({name:"flask"},gt,!1,function(e){i("RRBy")},"data-v-5ce0d404",null).exports;s.default.component("WidgetSelector",mt);var vt={name:"play",props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},data:function(){return{startTime:null,dismissSecs:1,dismissCountDown:0,feedback:{variant:"warning",message:""},status:"loading",sampleCounts:[],userSeenSamples:[],noData:!1,widgetPointer:null,widgetSummary:{},userSettings:{},serverSecret:"",groundTruthSamples:[],groundTruthFeedback:{variant:"danger",message:""},currentGroundTruth:{}}},watch:{currentLevel:function(){this.userData.score===this.currentLevel.min&&this.currentLevel.min&&(this.$refs.levelUp.show(),this.db.ref("/users/"+this.userInfo.displayName).child("level").set(this.currentLevel.level))},widgetPointer:function(){var e=this;this.widgetPointer&&this.db.ref("sampleSummary").child(this.widgetPointer).once("value",function(t){e.widgetSummary=t.val()})}},mounted:function(){this.initGroundTruth().then(this.initSampleCounts),this.initSeenSamples(),this.initUserSettings(),this.fetchServerSecret()},components:{Flask:ft},computed:{samplePriority:function(){return p.a.sortBy(this.sampleCounts,".value")},blankImage:function(){return this.config.play.blankImage},widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties},needsSecret:function(){return this.config.widgetUsesSecret}},methods:{initUserSettings:function(){var e=this;this.db.ref("userSettings").child(this.userInfo.displayName).on("value",function(t){var i=t.val();e.userSettings=null==i?{}:i})},initGroundTruth:function(){var e=this;return this.db.ref("sampleTruths").once("value",function(t){var i=t.val()||[];e.groundTruthSamples=p.a.map(i,function(e,t){return Xe()({".key":t},e)})})},updateUserSettings:function(e){e&&this.db.ref("userSettings").child(this.userInfo.displayName).set(e)},initSampleCounts:function(){var e=this;this.db.ref("sampleCounts").once("value",function(t){e.sampleCounts=p.a.map(t.val(),function(e,t){return{".key":t,".value":e}}),e.sampleCounts.length?(e.startTime=new Date,e.setNextSampleId()):e.noData=!0})},initSeenSamples:function(){var e=this;this.db.ref("userSeenSamples").child(this.userInfo.displayName).once("value",function(t){e.userSeenSamples=p.a.map(t.val(),function(e,t){return{".key":t,".value":e}})})},shuffle:function(e){for(var t=e.length,i=void 0,s=void 0;0!==t;)s=Math.floor(Math.random()*t),i=e[t-=1],e[t]=e[s],e[s]=i;return e},sampleUserPriority:function(){if(this.userInfo){var e=void 0;if(this.userSeenSamples){var t=p.a.map(this.userSeenSamples,function(e){return e[".key"]});e=(e=p.a.filter(this.samplePriority,function(e){return t.indexOf(e[".key"])<0})).length?e:this.samplePriority}else e=this.samplePriority;if(e.length){var i=e[0][".value"],s=p.a.filter(e,function(e){return e[".value"]===i});return this.shuffle(s)}return this.shuffle(this.samplePriority)}return null},sendWidgetResponse:function(e){var t=this.$refs.widget.getFeedback(e,this.currentGroundTruth);t.show&&(this.feedback=t,t.needsModal?this.$refs.widget.showFeedbackModal(this.currentGroundTruth):this.showAlert());var i=new Date-this.startTime;this.sendVote(e,i);var s=this.$refs.widget.getScore(e,this.currentGroundTruth);!this.currentLevel&&s<0&&(s=0),this.updateScore(s),this.updateSummary(this.$refs.widget.getSummary(e)),this.updateCount(),this.updateSeen(),this.setNextSampleId()},setNextSampleId:function(){this.startTime=new Date;var e=this.sampleUserPriority()[0];if(this.currentGroundTruth={},this.groundTruthSamples.length){var t=this.currentLevel.truth_prob;Math.random()<t&&((e=this.shuffle(this.groundTruthSamples)[0])===this.widgetPointer&&(e=this.shuffle(this.groundTruthSamples)[1]),this.groundTruthFeedback.message=e.feedback,this.currentGroundTruth=e)}e&&(this.widgetPointer=e[".key"])},sendVote:function(e,t){this.db.ref("votes").push({user:this.userInfo.displayName,sample:this.widgetPointer,response:e,time:t})},updateScore:function(e){this.db.ref("users").child(this.userInfo.displayName).child("score").transaction(function(t){return(t||0)+e})},updateSummary:function(e){this.db.ref("sampleSummary").child(this.widgetPointer).set(e)},updateCount:function(){var e=this;this.db.ref("sampleCounts").child(this.widgetPointer).transaction(function(e){return(e||0)+1}),p.a.map(this.sampleCounts,function(t){t[".key"]===e.widgetPointer&&(t[".value"]+=1)})},updateSeen:function(){this.db.ref("userSeenSamples").child(this.userInfo.displayName).child(this.widgetPointer).transaction(function(e){return(e||0)+1}),this.userSeenSamples.push({".key":this.widgetPointer,".value":1})},countDownChanged:function(e){this.dismissCountDown=e},showAlert:function(){this.dismissCountDown=this.dismissSecs},fetchServerSecret:function(){var e=this;this.db.ref("settings").child("secret").once("value").then(function(t){e.serverSecret=t.val()})}}},bt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container",attrs:{id:"play"}},[i("b-modal",{ref:"levelUp",attrs:{id:"levelUp",title:"You've Levelled Up!","ok-only":""}},[i("div",{staticClass:"my-4"},[i("h3",[e._v("Level "+e._s(e.currentLevel.level))]),e._v(" "),i("img",{attrs:{src:e.currentLevel.img,width:"120px",height:"120px"}}),e._v(" "),i("p",{staticClass:"lead"},[e._v("You've unlocked: "+e._s(e.currentLevel.character))])])]),e._v(" "),i("div",{staticClass:"main"},[i("b-alert",{staticClass:"toast",attrs:{show:e.dismissCountDown,variant:e.feedback.variant},on:{dismissed:function(t){e.dismissCountdown=0},"dismiss-count-down":e.countDownChanged}},[e._v("\n       "+e._s(e.feedback.message)+"\n    ")]),e._v(" "),e.noData?i("div",[i("h1",[e._v("There is no data in your database!")]),e._v(" "),i("p",{staticClass:"lead"},[e._v("Follow the instructions to set up your SwipesForScience App")]),e._v(" "),i("img",{staticClass:"blankImage",attrs:{src:e.blankImage,alt:"there is no data"}})]):i("div",[e.widgetPointer?i("WidgetSelector",{ref:"widget",attrs:{widgetType:e.widgetType,widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,needsSecret:e.needsSecret,serverSecret:e.serverSecret,playMode:"play"},on:{widgetRating:e.sendWidgetResponse,updateUserSettings:e.updateUserSettings}}):i("div",[i("Flask"),e._v(" "),i("p",{staticClass:"mt-3 pt-3 lead"},[e._v("loading...")])],1)],1)],1)],1)},staticRenderFns:[]};var wt=i("VU/8")(vt,bt,!1,function(e){i("Qe6P")},null,null).exports,yt={name:"login",props:{routerQuery:{type:Object}},data:function(){return{form:{email:null,password:null},errors:{show:!1,message:null}}},methods:{onSubmit:function(e){var t=this;e.preventDefault(),n.a.auth().signInWithEmailAndPassword(this.form.email,this.form.password).then(function(e){t.$emit("login",e),t.$router.push({name:"Play",query:t.routerQuery})},function(e){t.errors.show=!0,t.errors.message=e.message})}}},_t={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"login"}},[i("h1",[e._v(" Log In ")]),e._v(" "),i("div",{staticClass:"container fluid",attrs:{id:"signupForm"}},[i("b-alert",{attrs:{show:e.errors.show,variant:"danger"}},[e._v(e._s(e.errors.message))]),e._v(" "),i("b-form",{on:{submit:e.onSubmit}},[i("b-form-group",{attrs:{id:"emailAddressInputGroup",label:"Email address:","label-for":"emailAddress"}},[i("b-form-input",{attrs:{id:"emailAddress",type:"email",required:"",placeholder:"Enter email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),i("b-form-group",{attrs:{id:"passwordInputGroup",label:"Password:","label-for":"passwordInput"}},[i("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"Password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("Submit")])],1),e._v(" "),i("p",{staticClass:"mt-3"},[e._v("\n      Don't have an account? "),i("router-link",{attrs:{to:{name:"SignUp",query:e.routerQuery}}},[e._v("Create one")])],1)],1)])},staticRenderFns:[]};var St=i("VU/8")(yt,_t,!1,function(e){i("Tf0r")},null,null).exports,kt={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"terms"}},[i("h4",{staticStyle:{"text-align":"center"}},[e._v("\n      UNIVERSITY OF SOUTHERN CALIFORNIA\n      CONSENT FORM\n    ")]),e._v(" "),i("h5",{staticStyle:{"text-align":"center"}},[e._v("Crowdsourcing Quality Control of Brain Lesions")]),e._v(" "),i("br"),e._v(" "),i("h6",[e._v("RESEARCHERS:")]),e._v(" "),i("p",[e._v("Sook-Lei  Liew"),i("br"),e._v("\n    University of Southern California"),i("br"),e._v(" "),i("a",{attrs:{href:"#"}},[e._v("sliew@usc.edu")])]),e._v(" "),i("h6",[e._v("RESEARCHERS STATEMENT:")]),e._v(" "),i("p",[e._v("  We are asking you to be in a research study.  The purpose of this consent form is to give you the information you will need to help you decide whether to be in the study or not.  Please read the form carefully.  You may ask questions about the purpose of the research, what we would ask you to do, the possible risks and benefits, your rights as a volunteer, and anything else about the research or this form that is not clear. Please email keshavan@uw.edu if you have any questions. When we have answered all your questions, you can decide if you want to be in the study or not.  This process is called informed consent.\n  ")]),e._v(" "),i("h6",[e._v("PURPOSE OF THE STUDY")]),e._v(" "),i("p",[e._v("Image annotation is needed to extract data from images. The purpose of this study is to train better computer algorithms to annotate images, and also correct any errors the computer makes. We aim to 1) collect image annotation data from you, and 2) combine annotations from many users into the most accurate annotation. This information will be used to train new computer algorithms.\n      ")]),e._v(" "),i("h6",[e._v("STUDY PROCEDURES")]),e._v(" "),i("p",[e._v("You will be asked to log in. You may be given the option to use an existing social media login (e.g. Twitter, Facebook, Google, etc.), and you may be asked to create an anonymous username to be displayed to the public. You may also choose to include your social media avatar to display alongside your anonymous username in the public leaderboard. Alternatively, you may also have the option to use an anonymous login. You may provide your email when you sign up for an account if you wish to be contacted about future work related to this task.")]),e._v(" "),i("p",[e._v("You will be given instructions on how to annotate images for a particular task. Try your best to annotate the images as quickly and accurately as you can. You may complete however many tasks you wish. Each task can take anywhere from 30 seconds to 5 minutes. You may stop annotating at any time.\n    ")]),e._v(" "),i("p",[e._v("You may use any device with a web browser (computer, tablet, or phone). We will record all settings you use on the application, your annotations, your screen resolution, and your anonymous username. This data will be made publicly available to researchers.\n    ")]),e._v(" "),i("h6",[e._v("RISKS, STRESS, OR DISCOMFORT")]),e._v(" "),i("p",[e._v("Some people feel that providing information for research or having the research session recorded is an invasion of privacy. If you wish to remain anonymous, we recommend creating an anonymous nickname that does not include any identifiers relating to you.\n      ")]),e._v(" "),i("h6",[e._v("BENEFITS OF THE STUDY")]),e._v(" "),i("p",[e._v("This study will help us to extract accurate data from images. This information will be used for scientific research.\n      ")]),e._v(" "),i("h6",[e._v("CONFIDENTIALITY OF RESEARCH INFORMATION")]),e._v(" "),i("p",[e._v("Your social media login information (such as username and email address), if provided, will remain confidential and will not be shared outside the study team.\nGovernment or university staff sometimes review studies such as this one to make sure they are being done safely and legally. If a review of this study takes place, your records may be examined. The reviewers will protect your privacy. The study records will not be used to put you at legal risk of harm.\n      ")]),e._v(" "),i("h6",[e._v("RESEARCH-RELATED INJURY")]),e._v(" "),i("p",[e._v("If you think you have been harmed from being in this research, contact Sook-Lei Liew at "),i("a",{attrs:{href:"#"}},[e._v("sliew@usc.edu")])]),e._v(" "),i("p",[e._v("* Please note that we cannot ensure the confidentiality of information sent via e-mail.\n      ")]),e._v(" "),i("h6",[e._v("SUBJECTS STATEMENT")]),e._v(" "),i("p",[e._v("This study has been explained to me, and I understand the procedures, benefits, and risks of this study. I affirm that I am capable of consenting on my own behalf, and I volunteer to take part in this research. I have had a chance to ask questions. If I have questions later about the research, or if I have been harmed by participating in this study, I can contact one of the researchers listed on the first page of this consent form. If I have questions about my rights as a research subject, I can call the Human Subjects Division at (323) 442-0114 or email istar@usc.edu.\n      ")])])}]};var Ct=i("VU/8")({name:"terms",data:function(){return{}}},kt,!1,function(e){i("6Swe")},null,null).exports,Pt={name:"signup",data:function(){return{form:{email:"",password:"",password2:"",username:"",consented:!1},show:!0,errors:{show:!1,message:null}}},props:{config:{type:Object,required:!0}},components:{terms:Ct},computed:{validated:function(){return this.form.password===this.form.password2},consentFormLabel:function(){return this.form.consented?"You have consented!":"Click to read and sign the consent form"}},methods:{onSubmit:function(e){var t=this;e.preventDefault(),n.a.database().ref("users").child(this.form.username).once("value").then(function(e){e.val()?(t.errors.show=!0,t.errors.message="Username already exists! Please choose a unique username"):t.createAccount()})},saveConsent:function(e){e.preventDefault(),this.form.consented=!0,this.$refs.consentform.hide()},openConsentModal:function(){this.$refs.consentform.show()},createAccount:function(){var e=this;n.a.auth().createUserWithEmailAndPassword(this.form.email,this.form.password).then(function(t){e.updateProfile(t)},function(t){e.errors.show=!0,e.errors.message=t.message})},insertUser:function(e){n.a.database().ref("users").child(e.displayName).set({score:0,level:0,admin:!1,taken_tutorial:!1,consent:this.form.consented,consentedOn:new Date}).then(function(){}).catch(function(){})},updateProfile:function(e){var t=this;e.updateProfile({displayName:this.form.username}).then(function(){t.insertUser(e),t.config.needsTutorial?t.$router.replace("tutorial"):t.$router.replace("play")},function(e){t.errors.show=!0,t.errors.message=e.message})}}},xt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"signup"}},[i("h1",[e._v(" Sign Up ")]),e._v(" "),i("b-modal",{ref:"consentform",attrs:{id:"consentform",title:"Consent Form",size:"lg"}},[i("terms"),e._v(" "),i("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("b-form",{on:{submit:e.saveConsent}},[i("b-button",{attrs:{type:"submit",variant:"primary"}},[e._v("I Consent")])],1)],1)],1),e._v(" "),i("div",{staticClass:"container fluid",attrs:{id:"signupForm"}},[i("b-form",{attrs:{validated:""},on:{submit:e.onSubmit}},[i("b-alert",{attrs:{show:e.errors.show,variant:"danger"}},[e._v(e._s(e.errors.message))]),e._v(" "),e.config.needsConsent?i("b-form-group",{attrs:{id:"consentOpenButton",label:e.consentFormLabel,"label-for":"openConsent"}},[e.form.consented?e._e():i("b-button",{attrs:{variant:"success",id:"openConsent"},on:{click:e.openConsentModal}},[e._v(" Open Consent Form ")])],1):e._e(),e._v(" "),i("b-form-group",{attrs:{id:"emailAddressInputGroup",label:"Email address:","label-for":"emailAddress",description:"We'll never share your email with anyone else."}},[i("b-form-input",{attrs:{id:"emailAddress",type:"email",required:"",placeholder:"Enter email"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),i("b-form-group",{attrs:{id:"usernameInputGroup",label:"Username:","label-for":"usernameInput",description:"This will be displayed on the leaderboard"}},[i("b-form-input",{attrs:{id:"usernameInput",type:"text",required:"",placeholder:"Choose a username"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),i("b-form-group",{attrs:{id:"passwordInputGroup",label:"Password:","label-for":"passwordInput"}},[i("b-form-input",{attrs:{id:"passwordInput",type:"password",required:"",placeholder:"Password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),i("b-form-group",{attrs:{id:"password2InputGroup",label:"Password Again:","label-for":"password2Input"}},[i("b-alert",{attrs:{show:!e.validated,variant:"danger"}},[e._v("\n          Make sure your passwords match!\n        ")]),e._v(" "),i("b-form-input",{attrs:{id:"password2Input",type:"password",required:"",placeholder:"Confirm password"},model:{value:e.form.password2,callback:function(t){e.$set(e.form,"password2",t)},expression:"form.password2"}})],1),e._v(" "),i("b-button",{attrs:{type:"submit",variant:"primary",disabled:!(!e.config.needsConsent||e.validated&&e.form.consented)}},[e._v("Submit")]),e._v(" "),i("p",{staticClass:"mt-3"},[e._v("\n        Already have an account? "),i("router-link",{attrs:{to:"/login"}},[e._v("Log In")])],1)],1)],1)],1)},staticRenderFns:[]};var Tt=i("VU/8")(Pt,xt,!1,function(e){i("NGNY")},null,null).exports,It={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"unauthorized"}},[t("h1",[this._v(" Oops! You are not authorized ")]),this._v(" "),t("p",[this._v(" Please contact the sysadmin to get access to this page ")])])}]};var Ut=i("VU/8")({name:"unauthorized",data:function(){return{}}},It,!1,function(e){i("4ZIV")},null,null).exports,Ft={name:"leaderboard",props:{levels:{type:Object,required:!0},allUsers:{type:Object,required:!0}},computed:{allUsersList:function(){return p.a.filter(p.a.map(this.allUsers,function(e,t){return Xe()({},e,{".key":t})}),function(e){return".key"!==e[".key"]})}},data:function(){return{sortBy:"score",sortDesc:!0,fields:["rank","badge",{key:".key",label:"Player",sortable:!1},{key:"score",label:"Score",sortable:!0}]}}},qt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container",attrs:{id:"leaderboard"}},[i("h1",[e._v("Leaderboard")]),e._v(" "),i("b-table",{attrs:{striped:"",hover:"",items:e.allUsersList,fields:e.fields,"sort-desc":e.sortDesc,sortBy:e.sortBy},on:{"update:sortDesc":function(t){e.sortDesc=t},"update:sort-desc":function(t){e.sortDesc=t},"update:sortBy":function(t){e.sortBy=t},"update:sort-by":function(t){e.sortBy=t}},scopedSlots:e._u([{key:"rank",fn:function(t){return[e._v("\n    "+e._s(t.index+1)+"\n  ")]}},{key:"badge",fn:function(t){return[i("img",{staticClass:"avatar",attrs:{src:e.levels[t.item.level].img}})]}}])})],1)},staticRenderFns:[]};var Lt=i("VU/8")(Ft,qt,!1,function(e){i("HbkR")},null,null).exports,Rt=i("i2Do"),Et={render:function(){var e=this.$createElement,t=this._self._c||e;return t("svg",{staticClass:"arrows"},[t("text",{staticClass:"cont",attrs:{y:"11",x:"11 "}},[this._v("Next")]),this._v(" "),t("path",{staticClass:"a1",attrs:{d:"M0 0 L30 32 L60 0"}}),this._v(" "),t("path",{staticClass:"a2",attrs:{d:"M0 20 L30 52 L60 20"}}),this._v(" "),t("path",{staticClass:"a3",attrs:{d:"M0 40 L30 72 L60 40"}})])},staticRenderFns:[]};var Mt=i("VU/8")({name:"Arrow"},Et,!1,function(e){i("AtdB")},null,null).exports,jt={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"bg",attrs:{id:"background-wrap"}},[i("div",{staticClass:"bubble x1"}),e._v(" "),i("div",{staticClass:"bubble x2"}),e._v(" "),i("div",{staticClass:"bubble x3"}),e._v(" "),i("div",{staticClass:"bubble x4"}),e._v(" "),i("div",{staticClass:"bubble x5"}),e._v(" "),i("div",{staticClass:"bubble x6"}),e._v(" "),i("div",{staticClass:"bubble x7"}),e._v(" "),i("div",{staticClass:"bubble x8"}),e._v(" "),i("div",{staticClass:"bubble x9"}),e._v(" "),i("div",{staticClass:"bubble x10"})])}]};var Dt=i("VU/8")({name:"bubbles"},jt,!1,function(e){i("SoSK")},"data-v-b687790e",null).exports,Ot=i("bm7V");s.default.use(Ot,{container:"body",duration:500,easing:"ease",offset:-75,force:!0,cancelable:!0,onStart:!1,onDone:!1,onCancel:!1,x:!1,y:!0});var $t={name:"tutorial",components:{Arrow:Mt,Bubbles:Dt,WidgetSelector:mt,VStepper:Rt.VStepper},data:function(){return{scrollPosition:0,widgetSummary:{},userSettings:{},step:void 0}},props:{levels:{type:Object,required:!0},config:{type:Object,required:!0}},watch:{},computed:{widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties},tutSteps:function(){return this.config.tutorial.steps},steps:function(){return this.config.tutorial.steps.intro.length+(this.config.tutorial.steps.examples.length-1)},backgroundAnimation:function(){return this.config.tutorial.customBackgroundAnimation},bins:function(){for(var e=this.steps.intro.length+this.steps.examples.length,t=1/e,i=[],s=0;s<e;s+=1)i.push({bin:s,from:s*t,to:(s+1)*t});return i},currentBin:function(){var e=this,t=p.a.filter(this.bins,function(t){return e.scrollPosition<=t.to&&e.scrollPosition>t.from});return t.length?t[0]:{bin:0}},currentStage:function(){return this.currentBin.bin<this.steps.intro.length?Xe()({},this.steps.intro[this.currentBin.bin],{mode:"intro"}):Xe()({},this.steps.examples[this.currentBin.bin-this.steps.intro.length],{mode:"examples"})},nextStep:function(){return this.currentBin.bin<this.steps.intro.length-1?"#intro"+(this.currentBin.bin+1):"#example"+(this.currentBin.bin-this.steps.intro.length+1)}},methods:{tutorialComplete:function(){this.$emit("taken_tutorial",!0)},handleScroll:function(){var e=Math.max(document.documentElement.clientHeight,window.innerHeight||0),t=(window.scrollY-60)/(this.$refs.tutorial.clientHeight-e);this.scrollPosition=t<0?0:t>1?1:t}},created:function(){},destroyed:function(){}},Vt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"full"},[i("v-stepper",{ref:"stepper",attrs:{steps:e.steps},model:{value:e.step,callback:function(t){e.step=t},expression:"step"}}),e._v(" "),e._l(e.tutSteps.intro,function(t,s){return i("div",{key:"i"+s},[e.step===s?[i("div",{staticClass:"container"},[i("p",{staticClass:"mt-3 lead",domProps:{innerHTML:e._s(t.text)}}),e._v(" "),i("img",{staticClass:"pt-3 img",attrs:{src:t.image}})])]:e._e()],2)}),e._v(" "),e._l(e.tutSteps.examples,function(t,s){return i("div",{key:"e"+s},[e.step===s+e.tutSteps.intro.length?[i("div",{staticClass:"text-center message w-100 full",attrs:{id:"example"+s}},[i("p",{staticClass:"container lead",domProps:{innerHTML:e._s(t.text)}}),e._v(" "),t.pointer?i("div",{staticClass:"mt-3 scaleDown"},[i("WidgetSelector",{ref:"widget",refInFor:!0,attrs:{widgetType:e.widgetType,widgetPointer:t.pointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,playMode:"tutorial",userSettings:e.userSettings,tutorialStep:t.tutorialStep}})],1):e._e(),e._v(" "),t.tutorialCompleted?i("div",[i("b-button",{staticClass:"mt-3",attrs:{size:"lg",variant:"success"},on:{click:e.tutorialComplete}},[e._v("\n            Play now\n          ")])],1):e._e()])]:e._e()],2)}),e._v(" "),i("div",{staticClass:"mt-3 pt-3 text-center mx-auto w-100",staticStyle:{position:"absolute",bottom:"10px"}},[e.step?i("b-button",{attrs:{variant:"secondary",size:"lg"},on:{click:function(t){return e.$refs.stepper.previous()}}},[e._v("Previous")]):e._e(),e._v(" "),e.step!==e.steps?i("b-button",{attrs:{variant:"info",size:"lg"},on:{click:function(t){return e.$refs.stepper.next()}}},[e._v("Next")]):e._e()],1)],2)},staticRenderFns:[]};var Nt=i("VU/8")($t,Vt,!1,function(e){i("LOIk")},null,null).exports,At={name:"review",props:{userInfo:{type:Object,required:!0},userData:{type:Object,required:!0},levels:{type:Object,required:!0},currentLevel:{type:Object,required:!0},config:{type:Object,required:!0},db:{type:Object,required:!0}},components:{WidgetSelector:mt},data:function(){return{widgetPointer:"",widgetSummary:{},userSettings:{},chatMessage:"",chatHistory:[]}},computed:{chatOrder:function(){var e=[];return p.a.mapValues(this.chatHistory,function(t){e.push(t)}),e.reverse(),e},widgetType:function(){return this.config.widgetType},widgetProperties:function(){return this.config.widgetProperties}},watch:{$route:function(){this.widgetPointer=this.$route.params.key}},mounted:function(){this.widgetPointer=this.$route.params.key,this.setSampleInfo()},methods:{sendChat:function(e){var t=this;e.preventDefault();var i=this.$route.params.key;this.db.ref("chats").child("sampleChats").child(i).push({username:this.userData[".key"],message:this.chatMessage,time:(new Date).toISOString()}),this.db.ref("chats").child("sampleChatIndex").child(i).set({time:(new Date).toISOString()}),this.db.ref("chats").child("userChat").child(this.userData[".key"]).child(i).set({watch:1}),this.chatMessage="";var s=[];this.chatOrder.forEach(function(e){s.indexOf(e.username)<0&&e.username!==t.userData[".key"]&&s.push(e.username)}),s.forEach(function(e){t.db.ref("chats").child("userNotifications").child(e).child(i).set(!0)})},unravelFirebaseListObject:function(e){var t=[];return p.a.mapValues(e,function(e){t.push(e)}),t},setSampleInfo:function(){var e=this;this.db.ref("chats").child("sampleChats").child(this.widgetPointer).on("value",function(t){var i=t.val();e.chatHistory=i}),this.userInfo.displayName&&this.db.ref("userSettings").child(this.userInfo.displayName).once("value").then(function(t){e.userSettings=t.val()||{}}),this.db.ref("sampleSummary").child(this.widgetPointer).on("value",function(t){e.widgetSummary=t.val()})}}},zt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container",attrs:{id:"review"}},[i("div",{staticClass:"chat container"},[i("h3",{staticClass:"mb-2"},[e._v("Chat")]),e._v(" "),e.chatOrder.length?i("div",{staticClass:"chatHistory pl-3 pr-3 pt-3 pb-3 mb-3"},e._l(e.chatOrder,function(t){return i("p",{key:t.time,staticClass:"text-left"},[i("b",[e._v(e._s(t.username))]),e._v(": "+e._s(t.message)+"\n      ")])}),0):i("div",[i("p",[e._v("No one has said anything yet!")])]),e._v(" "),i("b-form",{on:{submit:e.sendChat}},[i("b-form-group",{attrs:{id:"exampleInputGroup1",label:"Enter chat message:","label-for":"exampleInput1",description:""}},[i("b-form-input",{attrs:{id:"exampleInput1",type:"text",required:"",placeholder:"Enter your message"},model:{value:e.chatMessage,callback:function(t){e.chatMessage=t},expression:"chatMessage"}}),e._v(" "),i("b-button",{staticClass:"mt-2",attrs:{variant:"primary"},on:{click:e.sendChat}},[e._v("Send")])],1)],1)],1),e._v(" "),i("div",[i("WidgetSelector",{ref:"widget",attrs:{widgetType:e.widgetType,widgetPointer:e.widgetPointer,widgetProperties:e.widgetProperties,widgetSummary:e.widgetSummary,userSettings:e.userSettings,playMode:""}})],1)])},staticRenderFns:[]};var Ht=i("VU/8")(At,zt,!1,function(e){i("npic")},null,null).exports,Bt={firebase:function(){return{sampleChat:{source:this.db.ref("chats").child("sampleChatIndex").orderByChild("time"),readyCallback:function(){var e=this;this.sampleChat.forEach(function(t){e.db.ref("chats").child("sampleChats").child(t[".key"]).orderByKey().limitToLast(1).on("value",function(i){var s=i.val();e.chatInfo[t[".key"]]=s[o()(s)[0]],e.$forceUpdate()})}),this.sampleChat.length||(this.noData=!0)}}}},data:function(){return{chatInfo:{},noData:!1}},props:{config:{type:Object,required:!0},db:{type:Object,required:!0}},computed:{orderedPosts:function(){return this.sampleChat.reverse()},blankChatImage:function(){return this.config.chats.blankImage}}},Wt={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-container",[e.noData?i("div",[i("h1",[e._v("Chats")]),e._v(" "),i("p",{staticClass:"lead"},[e._v("No one has said anything yet!")]),e._v(" "),i("img",{staticClass:"blankImage",attrs:{src:e.blankChatImage}})]):i("div",[i("h1",[e._v("Chats")]),e._v(" "),i("p",{staticClass:"lead"},[e._v("See which samples people are talking about")]),e._v(" "),e._l(e.sampleChat,function(t,s){return i("p",{key:s},[i("b-alert",{attrs:{show:""}},[i("router-link",{attrs:{to:"/review/"+t[".key"]}},[e._v(e._s(t[".key"]))]),e._v(" "),i("br"),e._v(" "),e.chatInfo[t[".key"]]?i("span",[i("b",[e._v(e._s(e.chatInfo[t[".key"]].username))]),e._v(" : "+e._s(e.chatInfo[t[".key"]].message)+"\n        ")]):e._e()],1)],1)})],2)])},staticRenderFns:[]};var Gt=i("VU/8")(Bt,Wt,!1,function(e){i("A0TE")},null,null).exports;s.default.use(Oe.a);var Qt=new Oe.a({scrollBehavior:function(){return{x:0,y:0}},routes:[{path:"*",redirect:"/login"},{path:"/",name:"Home",component:Qe},{path:"/about",name:"About",component:Ve},{path:"/profile",name:"Profile",component:Ze,meta:{requiresAuth:!0}},{path:"/play",name:"Play",component:wt,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:St},{path:"/signup",name:"SignUp",component:Tt},{path:"/terms",name:"Terms",component:Ct},{path:"/unauthorized",name:"Unauthorized",component:Ut},{path:"/leaderboard",name:"Leaderboard",component:Lt},{path:"/tutorial",name:"Tutorial",component:Nt},{path:"/chats",name:"Chats",component:Gt,meta:{requiresAuth:!0}},{path:"/review/:key",name:"Review",component:Ht},{path:"/admin",name:"Admin",component:Be,meta:{requiresAuth:!0,requiresAdmin:!0}}]});Qt.beforeEach(function(e,t,i){var s=n.a.auth().currentUser,r=e.matched.some(function(e){return e.meta.requiresAuth}),a=e.matched.some(function(e){return e.meta.requiresAdmin});r&&!s&&i({path:"/login",query:t.query}),"Play"===e.name&&(s?n.a.database().ref("/users/"+s.displayName).once("value").then(function(e){!e.val().taken_tutorial&&b.needsTutorial&&i({path:"/tutorial",query:t.query})}):i({path:"/login",query:t.query})),a?n.a.database().ref("/settings/admins/"+s.displayName).once("value").then(function(e){a&&!e.val()?i("unauthorized"):i()}):i()});var Yt=Qt;s.default.config.productionTip=!1;var Kt=void 0;n.a.initializeApp(b.firebaseKeys),n.a.auth().onAuthStateChanged(function(){Kt||(Kt=new s.default({el:"#app",template:"<App/>",components:{App:De},router:Yt}))})},PKAF:function(e,t){},Qe6P:function(e,t){},RRBy:function(e,t){},SoSK:function(e,t){},Tf0r:function(e,t){},UFIT:function(e,t){},UZuB:function(e,t){},X7DP:function(e,t){},"a+Tf":function(e,t){},e0XP:function(e,t){},eNLd:function(e,t){},fJom:function(e,t,i){e.exports=function(){return new Worker(i.p+"db10aa88bedf2b001d2f.worker.js")}},"i+8Z":function(e,t){},i3eD:function(e,t){},m0XO:function(e,t){},nHb0:function(e,t){},"nLH/":function(e,t){},nLSV:function(e,t){},npic:function(e,t){},qVDn:function(e,t){},r15W:function(e,t,i){"use strict";var s=i("E9Zr").a;var r=i("VU/8")(s,null,!1,function(e){i("X7DP")},null,null);t.a=r.exports},rrPM:function(e,t){},rx1Z:function(e,t){},xBZt:function(e,t){},xfUb:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2a01e59328341f3f7a8a.js.map